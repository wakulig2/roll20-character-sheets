<div class="main">
	<div class="buttonbar">
		<img class="headerimage" src="https://i.imgur.com/KnxTKFu.png" alt="Dragon Warriors" /><br>
		<button type="action" name="act_character" >Character</button>
		<button type="action" name="act_inventory" >Inventory</button>
		<button type="action" name="act_combat" >Combat</button>
		<button type="action" name="act_magic" >Magic</button>
		<button type="action" name="act_skills" >Skills</button>
		<button type="action" name="act_languages" >Languages</button>
		<button type="action" name="act_biographical" >Biography</button>
		<button type="action" name="act_documentation" >Documentation</button>
	</div>
	
	<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab' value='character' />
	
	<div class="character">
		<div class="common">
			Name<input class="sixteenlongtextinput" name="attr_character_name" type="text" /> 
			Profession<select name="attr_profession">
			    <option value="None" selected>(Pick One)</option> 
				<option value="Knight">Knight</option>
				<option value="Barbarian">Barbarian</option>
				<option value="Sorcerer">Sorcerer</option>
				<option value="Mystic">Mystic</option>
				<option value="Elementalist">Elementalist</option>
				<option value="Warlock">Warlock</option>
				<option value="Assassin">Assassin</option>
				<option value="Knave">Knave</option>
				<option value="Hunter">Hunter</option>
				<option value="Priest">Priest</option>
				<option value="Demonologist">Demonologist</option>
			</select>
			Rank<input class="fourshorttextinput" name="attr_rank" type="number" min="1" value="1" />
			Experience<input class="fourshorttextinput" name="attr_XP" type="number" value="0" />
		</div>
		<div class="attributes">
			<label class="boxheading charheading">Characteristics</label>
        			<div class="char1" >Strength</div><div class="charscore1" ><input class="fourshorttextinput" type="number" name="attr_strength" value="0" /></div><button class="button1 d20" type="roll" value="/roll {d20+[[?{Modifier?|0}]]}<@{strength}" name="roll_strengthcheck"></button>
        			<div class="char2" >Reflexes</div><div class="charscore2" ><input class="fourshorttextinput" type="number" name="attr_reflexes" value="0" /></div><button class="button2 d20" type="roll" value="/roll {d20+[[?{Modifier?|0}]]}<@{reflexes}" name="roll_reflexescheck"></button>
        			<div class="char3" >Intelligence </div> <div class="charscore3" > <input class="fourshorttextinput" type="number" name="attr_intelligence" value="0" /> </div><button class="button3 d20" type="roll" value="/roll {d20+[[?{Modifier?|0}]]}<@{intelligence}" name="roll_intelligencecheck"></button>
        			<div class="char4" >Psychic Talent</div><div class="charscore4" > <input class="fourshorttextinput" type="number" name="attr_psychictalent" value="0" /></div><button class="button4 d20" type="roll" value="/roll {d20+[[?{Modifier?|0}]]}<@{psychictalent}" name="roll_psychictalentcheck"></button>
        			<div class="char5" >Looks</div><div class="charscore5" ><input class="fourshorttextinput" type="number" name="attr_looks" value="0" /></div><button class="button5 d20" type="roll" value="/roll {d20+[[?{Modifier?|0}]]}<@{looks}" name="roll_lookscheck"></button>
		</div>
		<div class="atkdefattributes">
				<label class="boxheading cfheading">Base Combat Factors</label>
        			 <div class="cf1"> Attack </div> <div class="cfa"><input title="Base from profession/rank only" class="fourshorttextinput" type="number" name="attr_attack" value="0" /></div>
        			 <div class="cf2"> Defence </div> <div class="cfd"><input title="Base from profession/rank only" class="fourshorttextinput" type="number" name="attr_defence" value="0" /></div>
		</div>
		<div class="evaattribute">
			<label class="boxheading dodgeheading">Dodging</label>
        			 <div class=dodge>Base Evasion</div><div class="evade"><input title="Base from profession/rank only" class="fourshorttextinput" type="number" name="attr_evasion" value="0" /></div>
		</div>
		<div class="mamdattributes">
			<label class="boxheading mcfheading">Base Magical Combat Factors</label>
        			<div class=mcf1>Magical&nbsp;Attack</div><div class="mcfma"><input title="Base from profession/rank only" class="fourshorttextinput" type="number" name="attr_MagicalAttack" value="0" /></div><button class="button1 d20" type="roll" value="/roll {d20+[[?{Magical Defence|0}]]}<@{magicalattack}" name="roll_MagicalAttack"></button>
        			<div class=mcf2>Magical&nbsp;Defence</div><div class="mcfmd"><input title="Base from profession/rank only" class="fourshorttextinput" type="number" name="attr_MagicalDefence" value="0" /></div>
		</div>
		<div class="steperattributes">
			<label class="boxheading steperheading">Base Stealth and Perception</label>
			 <div class="steper1">Stealth</div> <div class="stealth"><input title="Base from profession/rank only" class="fourshorttextinput" type="number" name="attr_Stealth" value="0" /></div>
			 <div class="steper2">Perception</div> <div class="percep"><input title="Base from profession/rank only" class="fourshorttextinput" type="number" name="attr_Perception" value="0" /></div><button class="button1 d20" type="roll" value="/gmroll {d20+[[?{Opposing Stealth|0}]]}<@{perception}" name="roll_Perception"></button>
		</div>
		<div class="hpattributes">
			<label class="boxheading">Health Points</label>
			<label> Maximum Health Points <input class="fourshorttextinput" type="number" name="attr_maxhp" min="1" value="1" /></label>
			<label> Wounds Taken: </label>
				<div class="dots">
					<input type="hidden" name="attr_wound" class="sdot" value="0" />
					<input type="hidden" name="attr_maxhp" class="sbody" min="1" value="1" />
					<button title="1" type="action" name="act_wound_1" class="sdot gt-0">
					<span class="checked"></span>
					</button>
					<button title="2" type="action" name="act_wound_2" class="sdot gt-0 gt-1">
					<span class="checked"></span>
					</button>
					<button title="3" type="action" name="act_wound_3" class="sdot gt-0 gt-1 gt-2">
					<span class="checked"></span>
					</button>
					<button title="4" type="action" name="act_wound_4" class="sdot gt-0 gt-1 gt-2 gt-3">
					<span class="checked"></span>
					</button>
					<button title="5" type="action" name="act_wound_5" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4">
					<span class="checked"></span>
					</button>
					<button title="6" type="action" name="act_wound_6" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5">
					<span class="checked"></span>
					</button>    
					<button title="7" type="action" name="act_wound_7" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6">
					<span class="checked"></span>
					</button>    
					<button title="8" type="action" name="act_wound_8" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7">
					<span class="checked"></span>
					</button>
					<button title="9" type="action" name="act_wound_9" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8">
					<span class="checked"></span>
					</button> 
					<button title="10" type="action" name="act_wound_10" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9">
					<span class="checked"></span>
					</button>
					<button title="11" type="action" name="act_wound_11" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10">
					<span class="checked"></span>
					</button>
					<button title="12" type="action" name="act_wound_12" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11">
					<span class="checked"></span>
					</button>
					<button title="13" type="action" name="act_wound_13" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12">
					<span class="checked"></span>
					</button>
					<button title="14" type="action" name="act_wound_14" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13">
					<span class="checked"></span>
					</button>
					<button title="15" type="action" name="act_wound_15" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14">
					<span class="checked"></span>
					</button>
					<button title="16" type="action" name="act_wound_16" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15">
					<span class="checked"></span>
					</button>
					<button title="17" type="action" name="act_wound_17" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16">
					<span class="checked"></span>
					</button>
					<button  title="18" type="action" name="act_wound_18" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17">
					<span class="checked"></span>
					</button>
					<button title="19" type="action" name="act_wound_19" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18">
					<span class="checked"></span>
					</button>
					<button title="20" type="action" name="act_wound_20" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19">
					<span class="checked"></span>
					</button>
					<button title="21" type="action" name="act_wound_21" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20">
					<span class="checked"></span>
					</button>
					<button title="22" type="action" name="act_wound_22" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21">
					<span class="checked"></span>
					</button>
					<button title="23" type="action" name="act_wound_23" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22">
					<span class="checked"></span>
					</button>
					<button title="24" type="action" name="act_wound_24" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22 gt-23">
					<span class="checked"></span>
					</button>
					<button title="25" type="action" name="act_wound_25" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22 gt-23 gt-24">
					<span class="checked"></span>
					</button>
					<button title="26" type="action" name="act_wound_26" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22 gt-23 gt-24 gt-25">
					<span class="checked"></span>
					</button>
					<button title="27" type="action" name="act_wound_27" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22 gt-23 gt-24 gt-25 gt-26">
					<span class="checked"></span>
					</button>
					<button title="28" type="action" name="act_wound_28" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22 gt-23 gt-24 gt-25 gt-26 gt-27">
					<span class="checked"></span>
					</button>
					<button title="29" type="action" name="act_wound_29" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22 gt-23 gt-24 gt-25 gt-26 gt-27 gt-28">
					<span class="checked"></span>
					</button>
					<button title="30" type="action" name="act_wound_30" class="sdot gt-0 gt-1 gt-2 gt-3 gt-4 gt-5 gt-6 gt-7 gt-8 gt-9 gt-10 gt-11 gt-12 gt-13 gt-14 gt-15 gt-16 gt-17 gt-18 gt-19 gt-20 gt-21 gt-22 gt-23 gt-24 gt-25 gt-26 gt-27 gt-28 gt-29">
					<span class="checked"></span>
					</button>
					<input type="hidden" name="attr_wtwound" class="wtdot" value="0" />
					<input type="hidden" name="attr_kohp" class="wtbody" value="3" />
					<button title="-1" type="action" name="act_wtwound_1" class="wtdot wt-0">
					<span class="checked"></span>
					</button>
					<button title="-2" type="action" name="act_wtwound_2" class="wtdot wt-0 wt-1">
					<span class="checked"></span>
					</button>
					<button title="-3" type="action" name="act_wtwound_3" class="wtdot wt-0 wt-1 wt-2">
					<span class="checked"></span>
					</button>
				</div>
			<button type="action" name="act_wound_reset" class="wound_reset">Heal!</button>
		</div>
		<div class="AFattributes">
			<label class="boxheading">Armour</label>
		    <label>Type <input type="text" name="attr_Armour" value="None" readonly /></label>
			<div class="2colrow">
			    <div class="col2">
			        <img class="imgshield" src="https://i.imgur.com/pjGm1On.png" alt="Shield" />
			    </div>
			    <div class="col1">
			        <label>Armour Factor</label> 
			        <label><input title="Includes Magic Bonus" type="number" class="fourshorttextinput" name="attr_totalAF" value="(@{AF}+@{MagicAFbonus})" disabled="true" /></label>
					<label>Shield Equipped? <input type="checkbox" name="attr_shield" value="1" /></label>
					<input type="hidden" class="shield-toggle" name="attr_shield" value="0" />					
					<div class="shieldhidden"><label>Shield Die<input title="Modified by Guard/Abilities" type="hidden" name="attr_shieldsuccessvalue" value="1" /><input class="fourshorttextinput" type="text" name="attr_shielddievalue" value="1d6" readonly /></label><button class="d20" type="roll" value="/roll @{shielddievalue}<@{shieldsuccessvalue}" name="roll_shieldcheck"></button></div>
			    </div>
			</div>
		</div>
		<div class="finalcombatattributes">
			<label class="boxheading">Combat Summary</label>
			<label class="larger">Melee</label>
			<input type="hidden" name="attr_meleeabrbonus" value="0" /> <input type="hidden" name="attr_meleedmgbonus" value="0" /><input type="hidden" name="attr_guardabrmodifier" value="0" /><input type="hidden" name="attr_guarddamagemodifer" value="0" /><input type="hidden" name="attr_weaponskillabrmodifier" value="0" /><input type="hidden" name="attr_penetratingshotabrmodifier" value="0" /><input type="hidden" name="attr_armourpiercingmodifier" value="0" /><input type="hidden" name="attr_masterbowmanmodifier" value="0" />
			Equipped Weapon: <input class="eightmidtextinput" type="text" name="attr_meleeweapon" value="None" readonly /><button class="d20" type="roll" value="/roll {1d20+[[?{DEF|0}]]}<@{selected|finalmeleeattack}" name="roll_MeleeAttack"></button><br>
			ABR <input class="fourshorttextinput" type="text" name="attr_meleeabr" value="0d0" readonly /><button class="d20" type="roll" value="/roll @{meleeabr}+[[@{meleeabrbonus}[ Strength Bonus ]+@{magicmeleeweaponbonus}[ Magic Weapon Bonus ]+@{guardabrmodifier}[ Guard Modifier ]+@{weaponskillabrmodifier}[ Weapon Skill ]+@{armourpiercingmodifier}[ Armour Piercing ]+@{miscabrmelee}[ Miscellaneous Bonuses ] ]]" name="meleeabrcheck"></button><br>
			Damage <input class="fourshorttextinput" type="text" name="attr_meleedamage" value="0d0" readonly /><button class="button1 d20" type="roll" value="/roll @{meleedamage}+[[@{meleedmgbonus}[ Strength Bonus ]+@{magicmeleeweaponbonus}[ Magic Weapon Bonus ]+@{guarddamagemodifier}[ Guard Modifier ]+@{miscdamagemelee}[ Miscellaneous Bonuses ] ]]" name="meleedamagecheck"></button><br>
			<br>
			<img class="imgsword" src="https://i.imgur.com/uTrcbgb.png" alt="Sword" />
			<br>
			<label class="larger">Ranged</label>
			<input type="hidden" name="attr_rangedabrbonus" value="0" /> <input type="hidden" name="attr_rangeddmgbonus" value="0" />
			<span>
				Equipped Weapon: <input class="eightmidtextinput" type="text" name="attr_rangedweapon" value="None" readonly /><button class="d20" type="roll" value="/roll {d20+[[?{Ranged Combat Modifier|0}]]}<@{selected|finalrangedattack}" name="roll_RangedAttack"></button>
				<br>
				Ammunition Type: <input class="eightmidtextinput" type="text" name="attr_ammotype" value="None" readonly />
				<br>
				ABR <input class="fourshorttextinput" type="text" name="attr_rangedabr" value="0d0" readonly /><button class="d20" type="roll" value="/roll @{rangedabr}+[[ @{magicrangedweaponbonus}[ Magic Weapon Bonus ]+@{guardabrmodifier}[ Guard Modifier ]+@{weaponskillabrmodifier}[ Weapon Skill ]+@{penetratingshotabrmodifier}[ Penetrating Shot ]+@{masterbowmanmodifier}[ Master Bowman ]+@{armourpiercingmodifier}[ Armour Piercing ]+@{specialammoabrmodifier}[ Special Ammunition Modifier ]+@{miscabrranged}[ Miscellaneous Bonuses ] ]]" name="rangedabrcheck"></button>
				<br>
				Damage <input class="fourshorttextinput" type="text" name="attr_rangeddamage" value="0d0" readonly /><button class="d20" type="roll" value="/roll @{rangeddamage}+[[@{magicrangedweaponbonus}[ Magic Weapon Bonus ]+@{guarddamagemodifier}[ Guard Modifier ]+@{specialammodmgmodifier}[ Special Ammunition Modifier ]+@{miscdamageranged}[ Miscellaneous Bonuses ] ]]" name="rangeddamagecheck"></button>
				<br>
			</span>
			<div class="2colrow">
				<div class="col4">
					Range:<br>Short <input class="fourshorttextinput" type='number' name="attr_weaponshortrange" value="0" readonly /><br> Medium <input class="fourshorttextinput" type='number' name="attr_weaponmediumrange" value="0" readonly /><br> Long <input class="fourshorttextinput" type='number' name="attr_weaponlongrange" value="0" readonly /><br><br>
				</div>
				<div class="col3">
					<img class="imgbow" src="https://i.imgur.com/xsVzmiX.png" alt="Bow" />
				</div>
			</div>
			<span>		
				Final Melee Attack <input class="fourshorttextinput" type="number" name="attr_finalmeleeattack" value="0" readonly /> 
				<br>
				Final Melee Defence <input class="fourshorttextinput" type="number" name="attr_finalmeleedefence" value="0" readonly />
			</span>
			<br><br>
			<span>
				Final Ranged Attack <input class="fourshorttextinput" type="number" name="attr_finalrangedattack" value="0" readonly />
				<br>
				Final Ranged Defence <input class="fourshorttextinput" type="number" name="attr_finalrangeddefence" value="0" readonly />
			</span>	
		</div>

		<div class="mpattributes">
		    <input type="hidden" class="profession-toggle" name="attr_profession" value="0" />
		    <div class="mp nomagic">
		        <img src="https://i.imgur.com/TvsSUOU.png" alt="No Magic Attributes" />
		    </div>
		    <div class="mp martialhidden">
				<label class="boxheading">Advanced Guards</label>
    		        <input type="hidden" class="profession-toggle" name="attr_profession" value="0" />
        			Guard Taken <select name="attr_guardcurrent" readonly>
    			        <option value="Neutral" selected>Neutral (0)</option> 
    			        <option value="Hawk" >Hawk (1)</option> 
    			        <option value="Snake" >Snake (2)</option> 
    			        <option value="Wolf" >Wolf (3)</option>
    			        <option value="Bear" >Bear (4)</option> 
    			        <option value="Cat" >Cat (5)</option> 
    			        <option value="Crab" >Crab (6)</option>
    			    </select>
    			    <label>Melee Attack: <input type="number" name="attr_mattackmodded" value="0" readonly /></label>
    			    <label>Melee Defence: <input type="number" name="attr_mdefencemodded" value="0" readonly /></label>
    			    <label>Ranged Attack: <input type="number" name="attr_rattackmodded" value="0" readonly /></label>
    			    <label>Ranged Defence: <input type="number" name="attr_rdefencemodded" value="0" readonly /></label>

					<label>Evasion: <input type="number" name="attr_evasionmodded" value="0" readonly /></label>
        			<label>Other Modifications: </label><input type="text" name="attr_othermodifications" value="None" readonly />
    		</div>
		    <div class="mp mpattributeshidden">
    			<label class="boxheading"><span class="boxheading" type="text" name="attr_profession" ></span> Magic</label>
    			<input type="hidden" class="profession-toggle" name="attr_profession" value="0" />
    				<div class="frontmp standardmp">
						<label>Spell Expiry Check<button class="d20" type="roll" value="/roll 2d6mt2>12" name="roll_SpellExpiry"></button></label>
						<label><span type="text" class="text" name="attr_primaryelement" ></span> Magic Points: <span type="number" name="attr_maxmp" ></span></label>
    						<div class="dots">
    							<input type="hidden" name="attr_manaused" class="mdot" value="0" />
    							<input type="hidden" name="attr_maxmp" class="mbody" value="1" />
    							<button title="1" type="action" name="act_manaused_1" class="mdot mt-0">
    							<span class="checked"></span>
    							</button>
    							<button title="2" type="action" name="act_manaused_2" class="mdot mt-0 mt-1">
    							<span class="checked"></span>
    							</button>
    							<button title="3" type="action" name="act_manaused_3" class="mdot mt-0 mt-1 mt-2">
    							<span class="checked"></span>
    							</button>
    							<button title="4" type="action" name="act_manaused_4" class="mdot mt-0 mt-1 mt-2 mt-3">
    							<span class="checked"></span>
    							</button>
    							<button title="5" type="action" name="act_manaused_5" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4">
    							<span class="checked"></span>
    							</button>
    							<button title="6" type="action" name="act_manaused_6" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5">
    							<span class="checked"></span>
    							</button>    
    							<button title="7" type="action" name="act_manaused_7" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6">
    							<span class="checked"></span>
    							</button>    
    							<button title="8" type="action" name="act_manaused_8" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7">
    							<span class="checked"></span>
    							</button>
    							<button title="9" type="action" name="act_manaused_9" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8">
    							<span class="checked"></span>
    							</button> 
    							<button title="10" type="action" name="act_manaused_10" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9">
    							<span class="checked"></span>
    							</button>
    							<button title="11" type="action" name="act_manaused_11" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10">
    							<span class="checked"></span>
    							</button>
    							<button title="12" type="action" name="act_manaused_12" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11">
    							<span class="checked"></span>
    							</button>
    							<button title="13" type="action" name="act_manaused_13" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12">
    							<span class="checked"></span>
    							</button>
    							<button title="14" type="action" name="act_manaused_14" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13">
    							<span class="checked"></span>
    							</button>
    							<button title="15" type="action" name="act_manaused_15" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14">
    							<span class="checked"></span>
    							</button>
    							<button title="16" type="action" name="act_manaused_16" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15">
    							<span class="checked"></span>
    							</button>
    							<button title="17" type="action" name="act_manaused_17" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16">
    							<span class="checked"></span>
    							</button>
    							<button title="18" type="action" name="act_manaused_18" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17">
    							<span class="checked"></span>
    							</button>
    							<button title="19" type="action" name="act_manaused_19" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18">
    							<span class="checked"></span>
    							</button>
    							<button title="20" type="action" name="act_manaused_20" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19">
    							<span class="checked"></span>
    							</button>
    							<button title="21" type="action" name="act_manaused_21" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20">
    							<span class="checked"></span>
    							</button>
    							<button title="22" type="action" name="act_manaused_22" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21">
    							<span class="checked"></span>
    							</button>
    							<button title="23" type="action" name="act_manaused_23" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22">
    							<span class="checked"></span>
    							</button>
    							<button title="24" type="action" name="act_manaused_24" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23">
    							<span class="checked"></span>
    							</button>
    							<button title="25" type="action" name="act_manaused_25" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24">
    							<span class="checked"></span>
    							</button>
    							<button title="26" type="action" name="act_manaused_26" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25">
    							<span class="checked"></span>
    							</button>
    							<button title="27" type="action" name="act_manaused_27" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26">
    							<span class="checked"></span>
    							</button>
    							<button title="28" type="action" name="act_manaused_28" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26 mt-27">
    							<span class="checked"></span>
    							</button>
    							<button title="29" type="action" name="act_manaused_29" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26 mt-27 mt-28">
    							<span class="checked"></span>
    							</button>
    							<button title="30" type="action" name="act_manaused_30" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26 mt-27 mt-28 mt-29">
    							<span class="checked"></span>
    							</button>
    						</div>
						<label><button type="action" name="act_mp_reset" class="mp_reset">Refresh!</button></label>						
    				</div>
    				<div class="frontmp mysticmp">
    					<label>Psychic Fatigue Check: <br><input class="fourshorttextinput" type="number" name="attr_pfc" value="0" readonly /> - spell level <button class="d20" type="roll" value="/roll 1d20<[@{pfc}-?{Spell Level}]" name="roll_psychicfatiguecheck"></button></label><br>
						<label>ESP <input class="fourshorttextinput" type="number" name="attr_espchance" value="0" readonly />% <button class="d20" type="roll" value="!broll 1d100<@{espchance}" name="roll_espcheck" ></button></label><br>
						<label>Premonition <input class="fourshorttextinput" type="number" name="attr_premonitionchance" value="0" readonly />% <button class="d20" type="roll" value="!broll 1d100<@{premonitionchance}" name="roll_premonitioncheck"> </button></label>

    				</div>
    				<div class="frontmp elementalistmp">
    				<label><span type="text" name="attr_secondaryelement" ></span> Magic Points: <span type="number" name="attr_2maxmp" value="0" ></span></label>
    					<div class="dots">
    						<input type="hidden" name="attr_secmanaused" class="m2dot" value="0" />
    						<input type="hidden" name="attr_2maxmp" class="m2body" value="1" />
    						<button title="1" type="action" name="act_secmanaused_1" class="m2dot mt2-0">
    						<span class="checked"></span>
    						</button>
    						<button title="2" type="action" name="act_secmanaused_2" class="m2dot mt2-0 mt2-1">
    						<span class="checked"></span>
    						</button>
    						<button title="3" type="action" name="act_secmanaused_3" class="m2dot mt2-0 mt2-1 mt2-2">
    						<span class="checked"></span>
    						</button>
    						<button title="4" type="action" name="act_secmanaused_4" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3">
    						<span class="checked"></span>
    						</button>
    						<button title="5" type="action" name="act_secmanaused_5" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4">
    						<span class="checked"></span>
    						</button>
    						<button title="6" type="action" name="act_secmanaused_6" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5">
    						<span class="checked"></span>
    						</button>    
    						<button title="7" type="action" name="act_secmanaused_7" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6">
    						<span class="checked"></span>
    						</button>    
    						<button title="8" type="action" name="act_secmanaused_8" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7">
    						<span class="checked"></span>
    						</button>
    						<button title="9" type="action" name="act_secmanaused_9" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8">
    						<span class="checked"></span>
    						</button> 
    						<button title="10" type="action" name="act_secmanaused_10" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9">
    						<span class="checked"></span>
    						</button>
    						<button title="11" type="action" name="act_secmanaused_11" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10">
    						<span class="checked"></span>
    						</button>
    						<button title="12" type="action" name="act_secmanaused_12" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11">
    						<span class="checked"></span>
    						</button>
    						<button title="13" type="action" name="act_secmanaused_13" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12">
    						<span class="checked"></span>
    						</button>
    						<button title="14" type="action" name="act_secmanaused_14" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13">
    						<span class="checked"></span>
    						</button>
    						<button title="15" type="action" name="act_secmanaused_15" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14">
    						<span class="checked"></span>
    						</button>
    						<button title="16" type="action" name="act_secmanaused_16" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15">
    						<span class="checked"></span>
    						</button>
    						<button title="17" type="action" name="act_secmanaused_17" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16">
    						<span class="checked"></span>
    						</button>
    						<button title="18" type="action" name="act_secmanaused_18" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16 mt2-17">
    						<span class="checked"></span>
    						</button>
    						<button title="19" type="action" name="act_secmanaused_19" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16 mt2-17 mt2-18">
    						<span class="checked"></span>
    						</button>
    						<button title="20" type="action" name="act_secmanaused_20" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16 mt2-17 mt2-18 mt2-19">
    						<span class="checked"></span>
    						</button>
    					</div>
    			    	<label><button type="action" name="act_secmp_reset" class="mp_reset">Refresh!</button></label>
    				    <label><span type="text" name="attr_tertiaryelement" ></span> Magic Points: <span type="number" name="attr_3maxmp" value="0" ></span></label>
    					<div class="dots">
    						<input type="hidden" name="attr_termanaused" class="m3dot" value="0" />
    						<input type="hidden" name="attr_3maxmp" class="m3body" value="1" />
    						<button title="1" type="action" name="act_termanaused_1" class="m3dot mt3-0">
    						<span class="checked"></span>
    						</button>
    						<button title="2" type="action" name="act_termanaused_2" class="m3dot mt3-0 mt3-1">
    						<span class="checked"></span>
    						</button>
    						<button title="3" type="action" name="act_termanaused_3" class="m3dot mt3-0 mt3-1 mt3-2">
    						<span class="checked"></span>
    						</button>
    						<button title="4" type="action" name="act_termanaused_4" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3">
    						<span class="checked"></span>
    						</button>
    						<button title="5" type="action" name="act_termanaused_5" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4">
    						<span class="checked"></span>
    						</button>
    						<button title="6" type="action" name="act_termanaused_6" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5">
    						<span class="checked"></span>
    						</button>    
    						<button title="7" type="action" name="act_termanaused_7" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6">
    						<span class="checked"></span>
    						</button>    
    						<button title="8" type="action" name="act_termanaused_8" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7">
    						<span class="checked"></span>
    						</button>
    						<button title="9" type="action" name="act_termanaused_9" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8">
    						<span class="checked"></span>
    						</button> 
    						<button title="10" type="action" name="act_termanaused_10" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9">
    						<span class="checked"></span>
    						</button>
    						<button title="11" type="action" name="act_termanaused_11" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10">
    						<span class="checked"></span>
    						</button>
    						<button title="12" type="action" name="act_termanaused_12" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11">
    						<span class="checked"></span>
    						</button>
    						<button title="13" type="action" name="act_termanaused_13" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12">
    						<span class="checked"></span>
    						</button>
    						<button title="14" type="action" name="act_termanaused_14" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13">
    						<span class="checked"></span>
    						</button>
    						<button title="15" type="action" name="act_termanaused_15" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14">
    						<span class="checked"></span>
    						</button>
    						<button title="16" type="action" name="act_termanaused_16" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15">
    						<span class="checked"></span>
    						</button>
    						<button title="17" type="action" name="act_termanaused_17" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16">
    						<span class="checked"></span>
    						</button>
    						<button title="18" type="action" name="act_termanaused_18" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16 mt3-17">
    						<span class="checked"></span>
    						</button>
    						<button title="19" type="action" name="act_termanaused_19" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16 mt3-17 mt3-18">
    						<span class="checked"></span>
    						</button>
    						<button title="20" type="action" name="act_termanaused_20" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16 mt3-17 mt3-18 mt3-19">
    						<span class="checked"></span>
    						</button> 
    					</div>
    			    <label><button type="action" name="act_termp_reset" class="mp_reset">Refresh!</button></label>
    			</div>
			</div>
		</div>
	</div>
	
	<div class="inventory">
		<div class="possessions">
			<label class="boxheading">Possesions</label>
			<fieldset class="repeating_InventoryItems"> 
				Item <input class="twelvemidlongtextinput" type="text" name="attr_InventoryItem" value="" />
				Location <input class="eightmidtextinput" type="text" name="attr_ItemLocation" value="" />
				Quantity <input class="fourshorttextinput" type="number" name="attr_inventoryqty" value="1" />
				Encumbrance Value <input class="fourshorttextinput" type="number" name="attr_encumbranceValue" value="0" />
			</fieldset>
		</div>
		<div class="money">
			<div class="2colrow">
				<label class="boxheading">Coin Purse</label>
				<div class="col2">
					<label>Crowns <input class="fourshorttextinput" type="number" name="attr_gc" value="0" /> </label>
					<label>Florins <input class="fourshorttextinput" type="number" name="attr_sf" value="0" /> </label>
					<label>Pennies <input class="fourshorttextinput" type="number" name="attr_cp" value="0" /> </label>
				</div>
				<div class="col1">
					<img class="imgchest" src="https://i.imgur.com/Mz8a04v.png" alt="Coin Chest" />
				</div>
			</div>
			<label>Other wealth </label>
			<textarea name="attr_OtherWealth"></textarea>
		</div>
		<div class="armour">
			<label class="boxheading">Armour</label>
			Type <input class="fourshorttextinput" type="text" name="attr_Armour" value="" />
			<br>
			Armour Factor <input class="fourshorttextinput" type="number" name="attr_AF" min='0' value="0" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Magic Bonus <input class="fourshorttextinput" type="number" name="attr_MagicAFbonus" min="0" max="3" value="0" />
			<br><br>
			<input type="hidden" name="attr_totalAF" value="(@{AF}+@{MagicAFbonus})" disabled="true" />
			Attack Penalty <input class="fourshorttextinput" title="Express as a positive number" type="number" name="attr_ArmourAttackPenalty" min='0' value="0" />
			<br>
			Defence Penalty <input class="fourshorttextinput" title="Express as a positive number" type="number" name="attr_ArmourDefencePenalty" min='0' value="0" />
			<br>
			Stealth Penalty <input class="fourshorttextinput" title="Express as a positive number" type="number" name="attr_ArmourStealthPenalty" min='0' value="0" />
			<br><br><br>
			<div class="3colrow">
				<div class="skullcol">
					<img class="skullimg" src="https://i.imgur.com/CrBuh7g.png" alt="Helmed Skull" />
				</div>
				<div class="shieldcol">
					Shield Equipped?
					<br>
					Magic Bonus
					<br>
					Shield Die
				</div>
				<div class="inputscol">
					<input class="fourshorttextinput" type="checkbox" name="attr_shield" value="1" />
					<br> 
					<input class="fourshorttextinput" type='number' name='attr_magicshield' value='0' /> 
					<br>
					<input class="fourshorttextinput" type="text" name="attr_shielddievalue" value="1d6" />
				</div>
			</div>
		</div>

		<div class="weapons">
			<label class="boxheading">Melee Weapons</label>
			<fieldset class="repeating_meleeweapons"> 
				<input class="eightmidtextinput" type="text" name="attr_meleeweapon" value="None" />
				Magic Bonus <input class="fourshorttextinput" type="number" name="attr_magicmeleeweaponbonus" min="0" max="3" value="0" />
				Armour Bypass Roll <input class="fourshorttextinput" type="text" name="attr_meleeabr" value="0" />
				Damage <input class="fourshorttextinput" type="text" name="attr_meleedamage" value="0" size="4" />
				Equipped <input type="checkbox" name="attr_equippedmeleewep" value="1" />
				<input type="hidden" name="attr_WeaponWeight" value="1" />
			</fieldset>
			<label class="boxheading">Ranged Weapons</label>
			<fieldset class="repeating_rangedweapons"> 
				<input class="eightmidtextinput" type="text" name="attr_rangedweapon" value="None" />
				Magic Bonus <input class="fourshorttextinput" type="number" name="attr_magicrangedweaponbonus" min="0" max="3" value="0" />
				Armour Bypass Roll <input class="fourshorttextinput" type="text" name="attr_rangedabr" value="0" />
				Damage <input class="fourshorttextinput" type="text" name="attr_rangeddamage" value="0" size="4" />
				Equipped <input type="checkbox" name="attr_equippedrangedwep" value="1" />
				<br>
				Short <input class="fourshorttextinput" type="number" name="attr_weaponshortrange" value="0" />
				Medium <input class="fourshorttextinput" type="number" name="attr_weaponmediumrange" value="0" />
				Long <input class="fourshorttextinput" type="number" name="attr_weaponlongrange" value="0" />
				<input type="hidden" name="attr_weaponWeight" value="1" />
			</fieldset>
			<label class="boxheading">Ammunition</label>
			<fieldset class="repeating_ammo"> 
				Ammunition Type <input class="sixteenlongtextinput" type="text" name="attr_ammotype" value="None" />
				Quantity <input class="fourshorttextinput" type="number" name="attr_ammoqty" value="0" />
				Magic Bonus <input class="fourshorttextinput" type="number" name="attr_magicammobonus" min="0" max="3" value="0" />
				Special Attack Modifier <input class="fourshorttextinput" type="number" name="attr_specialammomodifier" value="0" />
				Special ABR Modifier <input class="fourshorttextinput" type="number" name="attr_specialammoabrmodifier" value="0" />
				Special Damage Modifier <input class="fourshorttextinput" type="number" name="attr_specialammodmgmodifier" value="0" />
				Equipped <input type="checkbox" name="attr_equippedammo" value="1" />

			</fieldset>
		</div>
		<div class="encumbrance">
			<div class="2colrow">
				<label class="boxheading">Encumbrance</label>
				<div class="encumbrancecol">
					<label>Total Encumbrance <input class="fourshorttextinput" title="Includes all equipment, coins, weapons, ammunition and shield if equipped" type="number" name="attr_totalencumbrance" value="0" /> </label>
					<label>Maximum Encumbrance <input class="fourshorttextinput" title ="Determined by Strength score" type="number" name="attr_maxenc" value="0" /></label>
				</div>
				<div class="liftclawcol">
					<img class="liftclaw" src="https://i.imgur.com/gvqoIzZ.png" alt="Encumbrance" />
				</div>
			</div>
		</div>
	</div>

	<div class="combat">
		<div class="basemeleeattributes">
			<label class="boxheading">Miscellaneous Modifiers - Melee Combat</label>
			<input class="fourshorttextinput" title="Attack, Includes modifiers from armour, and melee weapons" type='hidden' name='attr_basemeleeattack' value='0' /> 
			<input class="fourshorttextinput" title="Defence, Includes modifiers from armour, shield, and melee weapons" type='hidden' name='attr_basemeleedefence' value='0' />
			<label>Attack Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscattackmelee" value="0" /></label>				
			<label>Defence Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscdefencemelee" value="0" /></label>
			<label>Armour Bypass Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscabrmelee" value="0" /></label>		
			<label>Damage Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscdamagemelee" value="0" /></label>		
		
		</div>
		<div class="baserangedattributes">
			<label class="boxheading">Miscellaneous Modifiers - Ranged Combat</label>
			<input class="fourshorttextinput" title="Attack, Includes modifiers from armour, ranged weapons and ammunition" type='hidden' name='attr_baserangedattack' value='0' />
			<input class="fourshorttextinput" title="Defence, Includes modifiers from armour and shield" type='hidden' name='attr_baserangeddefence' value='0' />
			<label>Attack Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscattackranged" value="0" /></label>
			<label>Defence Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscdefenceranged" value="0" /></label>
			<label>Armour Bypass Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscabrranged" value="0" /></label>		
			<label>Damage Modifier <input class="fourshorttextinput" title="Can be a positive or negative number." type="number" name="attr_miscdamageranged" value="0" /></label>		
	
		</div>
		<div class="combatguards">
			<input type="hidden" class="profession-toggle" name="attr_profession" value="0" />
				<div class="melee basicguards">
					<label class="boxheading">Basic Guards</label>
					<select name="attr_guardcurrent">
    					<option value="Neutral" selected>Neutral (0)</option> 
	  	  				<option value="Offensive" >Offensive (8)</option> 
   		 	        	<option value="Defensive" >Defensive (7)</option> 
				    </select>
    			    <label>Attack: <input class="fourshorttextinput" type="number" name="attr_mattackmodded" value="0"  /></label>
    		   	 	<label>Defence: <input class="fourshorttextinput" type="number" name="attr_mdefencemodded" value="0" /></label>
    				<label>Evasion: <input class="fourshorttextinput" type="number" name="attr_evasionmodded" value="0" /></label>
    				<label>Other Modifications: <input class="sixteenlongtextinput" type="text" name="attr_othermodifications" value="None" /></label>  			
				</div>
				<div class="melee advancedguards">
					<label class="boxheading">Advanced Guards</label>
					<select name="attr_guardcurrent">
    					<option value="Neutral" selected>Neutral (0)</option> 
    					<option value="Hawk" >Hawk (1)</option> 
    	        		<option value="Snake" >Snake (2)</option> 
    	    	    	<option value="Wolf" >Wolf (3)</option>
				        <option value="Bear" >Bear (4)</option> 
				        <option value="Cat" >Cat (5)</option>
				        <option value="Crab" >Crab (6)</option>
					</select>
					<label>Guard Countered? <input type="checkbox" name="attr_guardcountered" value="1" /></label>
					<br>
					<label class="boxheading">Guard Modified Combat Factors</label>
					<label>Melee Attack: <input class="fourshorttextinput" type="number" name="attr_mattackmodded" value="0" /></label>
					<label>Melee Defence: <input class="fourshorttextinput" type="number" name="attr_mdefencemodded" value="0" /> </label>
					<br>
					<label>Ranged Attack: <input class="fourshorttextinput" type="number" name="attr_rattackmodded" value="0" /></label>
					<label>Ranged Defence: <input class="fourshorttextinput" type="number" name="attr_rdefencemodded" value="0" /> </label>
					<br>
					<label>Evasion: <input class="fourshorttextinput" type="number" name="attr_evasionmodded" value="0" /> </label>
					<br>
					<label>Other Effects: <textarea name="attr_othermodifications" > None </textarea></label>
				</div>
			</div>
			<div class="classcombatabilities">
				<input type="hidden" class="profession-toggle" name="attr_profession" value="0" />	
				<div class="melee barbarianmelee">
					<label class="boxheading">Barbarian Profession Abilities</label>
					Berserk Defence Penalty: <input class="fourshorttextinput" title="By default this bonus applies to Melee attacks only. See below." type="number" name="attr_berserkneg" step="3" value="0"/> Attack Bonus <input class="fourshorttextinput" type="number" name="attr_berserkpos" value="0" />
					<br>
					<label>Activate Bloodrage <input class="fourshorttextinput" title="Deactivates all other class abilities." type="checkbox" name="attr_bloodrageselect" value="1"  /></label>
					<input type="hidden" name="attr_bloodrageactive" value="0" />
					<br>
					<label class="subtext"><input class="fourshorttextinput" title="Rule Option" type="checkbox" name="attr_berserktoranged" value="1" />Check this box to apply Berserk bonuses to both melee and <i>ranged</i> attacks.</label>
				</div>
				<div class="melee knightmelee">
					<label class="boxheading">Knight Profession Abilities</label>
					Activated abilities apply without regard to rules restrictions, for example Weaponskill applies a bonus to all Armour Bypass rolls while active. Manual control is required.
					<span>Activate Expert Parry <input type="checkbox" name="attr_expertparryselect" value="1" /></span><br>
					<span>Activate Weaponskill <input type="checkbox" name="attr_weaponskillselect" value="1" /></span><br>
					<div>Activate Main Guache: Inactive <input type="radio" name="attr_mainguacheactive" value="0" /> Defensive <input type="radio" name="attr_mainguacheactive" value="1" /> Offensive <input type="radio" name="attr_mainguacheactive" value="2" /></div><br>
					<span>Activate Master Bowman <input type="checkbox" name="attr_masterbowmanselect" value="1" /> </span>
				</div>
				<div class="melee warlockmelee">
					<label class="boxheading">Warlock Profession Abilities</label>
					Activated abilities apply without regard to rules restrictions, the Non-Proficiency penalty applies all rolls while active. Manual control is required.
					<span>Activate Non-Proficient Weapon <input type="checkbox" name="attr_nonprofselect" value="2"  /></span>
				</div>
				<div class="melee assassinmelee">
					<label class="boxheading">Assassin Profession Abilities</label>
					Activated abilities apply without regard to rules restrictions. Armour Piercing applies a bonus to all Armour Bypass rolls while active. Manual control is required.
					<span>Activate Armour Peircing <input type="checkbox" name="attr_armourpiercingselect" value="1" /> </span>
					<span>Activate Deathvow <input type="checkbox" name="attr_deathvowselect" value="10"  /> </span>
				</div>
				<div class="melee huntermelee">
					<label class="boxheading">Hunter Profession Abilities</label>
					Activated abilities apply without regard to rules restrictions, for example Penetrating Shot applies a bonus to all Ranged Armour Bypass rolls while active. Manual control is required.
					<span>Precise Shot Defence Penalty <input class="fourshorttextinput" type="number" name="attr_preciseneg" step="3" value="0" /> Attack Bonus <input class="fourshorttextinput" type="number" name="attr_precisepos" value="0"  /></span>
					<br>
					<span>Stillness Defence Penalty <input class="fourshorttextinput" type="number" name="attr_stillnessneg" step="2" value="0" /> Stealth Bonus <input class="fourshorttextinput" type="number" name="attr_stillnesspos" value="0"  /></span><br>
					<div>Penetrating Shot Skill Level: None <input type="radio" name="attr_penetratingshotmultiplier" value="0"> Once <input type="radio" name="attr_penetratingshotmultiplier" value="1"> Twice <input type="radio" name="attr_penetratingshotmultiplier" value="2"></div><br>
					<span>Activate Penetrating Shot <input type="checkbox" name="attr_penetratingshotselect" value="1" /></span>
				</div>
				<div class="melee nomelee">
					<img class="riderimg" src="https://i.imgur.com/TvsSUOU.png" alt="No Magic Attributes" />
				</div>
	
			</div>	
		<div class="finalcombatattributes">
			<label class="boxheading">Totaled Combat Factors</label>
			<span>		
				Final Melee Attack <input title="This is the score after all magic weapon modifiers, guard modifiers and profession abilitites have been applied." class="fourshorttextinput" type="number" name="attr_finalmeleeattack" value="0" readonly /> 
				Final Melee Defence <input title="This is the score after all magic weapon modifiers, shield modifiers, guard modifiers and profession abilitites have been applied." class="fourshorttextinput" type="number" name="attr_finalmeleedefence" value="0" readonly />
			</span>
			<br>
			<span>
				Final Ranged Attack <input title="This is the score after all magic weapon and ammunition modifiers, guard modifiers and profession abilitites have been applied." class="fourshorttextinput" type="number" name="attr_finalrangedattack" value="0" readonly />
				Final Ranged Defence <input title="This is the score after all shield modifiers, guard modifiers and profession abilitites have been applied." class="fourshorttextinput" type="number" name="attr_finalrangeddefence" value="0" readonly />
			</span>
			<br><br>	
			<span>Equipped Melee Weapon: <input class="eightmidtextinput" type="text" name="attr_meleeweapon" value="None" readonly /><button class="d20" type="roll" value="/roll {1d20+[[?{DEF|0}]]}<@{selected|finalmeleeattack}" name="roll_MeleeAttack"></button>
				ABR <input class="fourshorttextinput" type="text" name="attr_meleeabr" value="0d0" readonly /><button class="d20" type="roll" value="/roll @{meleeabr}+[[@{meleeabrbonus}[ Strength Bonus ]+@{magicmeleeweaponbonus}[ Magic Weapon Bonus ]+@{guardabrmodifier}[ Guard Modifier ]+@{weaponskillabrmodifier}[ Weapon Skill ]+@{armourpiercingmodifier}[ Armour Piercing ]+@{miscabrmelee}[ Miscellaneous Bonuses ] ]]" name="meleeabrcheck"></button>
				Damage <input class="fourshorttextinput" type="text" name="attr_meleedamage" value="0d0" readonly /><button class="button1 d20" type="roll" value="/roll @{meleedamage}+[[@{meleedmgbonus}[ Strength Bonus ]+@{magicmeleeweaponbonus}[ Magic Weapon Bonus ]+@{guarddamagemodifier}[ Guard Modifier ]+@{miscdamagemelee}[ Miscellaneous Bonuses ] ]]" name="meleedamagecheck"></button>
			</span>
			<br>
			<span>
					Shield Equipped? <input type="checkbox" name="attr_shield" value="1" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					Shield Die<input type="hidden" name="attr_shieldsuccessvalue" value="1" />
					<input class="fourshorttextinput" type="text" name="attr_shielddievalue" value="1d6" />
					<button class="d20" type="roll" value="/roll @{shielddievalue}<@{shieldsuccessvalue}" name="roll_shieldcheck"></button>
			</span>	
			<br><br>
			<span>
				Equipped Ranged Weapon: <input class="eightmidtextinput" type="text" name="attr_rangedweapon" value="None" readonly /><button class="d20" type="roll" value="/roll {d20+[[?{Ranged Combat Modifier|0}]]}<@{selected|finalrangedattack}" name="roll_RangedAttack"></button>
				ABR <input class="fourshorttextinput" type="text" name="attr_rangedabr" value="0d0" readonly /><button class="d20" type="roll" value="/roll @{rangedabr}+[[ @{magicrangedweaponbonus}[ Magic Weapon Bonus ]+@{guardabrmodifier}[ Guard Modifier ]+@{weaponskillabrmodifier}[ Weapon Skill ]+@{penetratingshotabrmodifier}[ Penetrating Shot ]+@{masterbowmanmodifier}[ Master Bowman ]+@{armourpiercingmodifier}[ Armour Piercing ]+@{specialammoabrmodifier}[ Special Ammunition Modifier ]+@{miscabrranged}[ Miscellaneous Bonuses ] ]]" name="rangedabrcheck"></button>
				Damage <input class="fourshorttextinput" type="text" name="attr_rangeddamage" value="0d0" readonly /><button class="d20" type="roll" value="/roll @{rangeddamage}+[[@{magicrangedweaponbonus}[ Magic Weapon Bonus ]+@{guarddamagemodifier}[ Guard Modifier ]+@{specialammodmgmodifier}[ Special Ammunition Modifier ]+@{miscdamageranged}[ Miscellaneous Bonuses ] ]]" name="rangeddamagecheck"></button>
			</span>
			<br>
			<span> 
				Equipped Ammunition Type: <input class="eightmidtextinput" type="text" name="attr_ammotype" value="None" readonly /> 
				<br>
				Special Ammunition Modifiers: Attack <input class="fourshorttextinput" type="number" name="attr_specialammomodifier" value="0" />
				Armour Bypass <input class="fourshorttextinput" type="number" name="attr_specialammoabrmodifier" value="0" />
				Damage <input class="fourshorttextinput" type="number" name="attr_specialammodmgmodifier" value="0" />
			</span>	
			<br>
			<span>
				Ranges: Short <input class="fourshorttextinput" type='number' name="attr_weaponshortrange" value="0" readonly /> 
				Medium <input class="fourshorttextinput" type='number' name="attr_weaponmediumrange" value="0" readonly /> 
				Long <input class="fourshorttextinput" type='number' name="attr_weaponlongrange" value="0" readonly />
			</span>
			<br>
			<br>
		</div>
	</div>

	<div class="magic">
		<div class="manabox">
			<input type="hidden" class="profession-toggle" name="attr_profession" value="0" />
			<div class="mana elementalistattributes">
				<label class="boxheading">Elemental Specialisms</label>
				<img class="elementimage" src="https://i.imgur.com/askHpqp.png" alt="The Elements: Earth, Air, Fire, Water, Darkness" />
				<label>Primary Element</label>
				<select name="attr_primaryelement"> 
					<option value=" " selected>(Pick One)</option>
					<option value="Earth" >Earth (moonset)</option>
					<option value="Air" >Air (noon)</option>
					<option value="Water" >Water (moonrise)</option>
					<option value="Fire">Fire (sunrise)</option>
					<option value="Darkness" >Darkness (sunset)</option>
				</select><br>
				<label>Secondary Element </label>
				<select name="attr_secondaryelement"> 
					<option value=" " selected>(Pick One)</option>
					<option value="Earth">Earth (moonset)</option>
					<option value="Air">Air (noon)</option>
					<option value="Water">Water (moonrise)</option>
					<option value="Fire">Fire (sunrise)</option>
				</select>
				<label>Secondary Element</label>
				<select name="attr_tertiaryelement"> 
	  			   <option value=" " selected>(Pick One)</option>
					<option value="Earth">Earth (moonset)</option>
					<option value="Air">Air (noon)</option>
					<option value="Water">Water (moonrise)</option>
					<option value="Fire">Fire (sunrise)</option>
				</select>
			</div>
				<div class="mana standardmana">
					<label class="boxheading">Magic Points</label>
				    <label><span name="attr_primaryelement" ></span> Magic Points <input class="fourshorttextinput" type="number" name="attr_maxmp" value="0" /></label>
				    <label>Magic Points Used: </label>
						<div class="dots">
							<input type="hidden" name="attr_manaused" class="mdot" value="0" />
							<input type="hidden" name="attr_maxmp" class="mbody" value="1" />
							<button title="1" type="action" name="act_manaused_1" class="mdot mt-0">
    							<span class="checked"></span>
    							</button>
    							<button title="2" type="action" name="act_manaused_2" class="mdot mt-0 mt-1">
    							<span class="checked"></span>
    							</button>
    							<button title="3" type="action" name="act_manaused_3" class="mdot mt-0 mt-1 mt-2">
    							<span class="checked"></span>
    							</button>
    							<button title="4" type="action" name="act_manaused_4" class="mdot mt-0 mt-1 mt-2 mt-3">
    							<span class="checked"></span>
    							</button>
    							<button title="5" type="action" name="act_manaused_5" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4">
    							<span class="checked"></span>
    							</button>
    							<button title="6" type="action" name="act_manaused_6" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5">
    							<span class="checked"></span>
    							</button>    
    							<button title="7" type="action" name="act_manaused_7" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6">
    							<span class="checked"></span>
    							</button>    
    							<button title="8" type="action" name="act_manaused_8" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7">
    							<span class="checked"></span>
    							</button>
    							<button title="9" type="action" name="act_manaused_9" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8">
    							<span class="checked"></span>
    							</button> 
    							<button title="10" type="action" name="act_manaused_10" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9">
    							<span class="checked"></span>
    							</button>
    							<button title="11" type="action" name="act_manaused_11" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10">
    							<span class="checked"></span>
    							</button>
    							<button title="12" type="action" name="act_manaused_12" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11">
    							<span class="checked"></span>
    							</button>
    							<button title="13" type="action" name="act_manaused_13" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12">
    							<span class="checked"></span>
    							</button>
    							<button title="14" type="action" name="act_manaused_14" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13">
    							<span class="checked"></span>
    							</button>
    							<button title="15" type="action" name="act_manaused_15" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14">
    							<span class="checked"></span>
    							</button>
    							<button title="16" type="action" name="act_manaused_16" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15">
    							<span class="checked"></span>
    							</button>
    							<button title="17" type="action" name="act_manaused_17" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16">
    							<span class="checked"></span>
    							</button>
    							<button title="18" type="action" name="act_manaused_18" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17">
    							<span class="checked"></span>
    							</button>
    							<button title="19" type="action" name="act_manaused_19" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18">
    							<span class="checked"></span>
    							</button>
    							<button title="20" type="action" name="act_manaused_20" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19">
    							<span class="checked"></span>
    							</button>
    							<button title="21" type="action" name="act_manaused_21" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20">
    							<span class="checked"></span>
    							</button>
    							<button title="22" type="action" name="act_manaused_22" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21">
    							<span class="checked"></span>
    							</button>
    							<button title="23" type="action" name="act_manaused_23" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22">
    							<span class="checked"></span>
    							</button>
    							<button title="24" type="action" name="act_manaused_24" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23">
    							<span class="checked"></span>
    							</button>
    							<button title="25" type="action" name="act_manaused_25" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24">
    							<span class="checked"></span>
    							</button>
    							<button title="26" type="action" name="act_manaused_26" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25">
    							<span class="checked"></span>
    							</button>
    							<button title="27" type="action" name="act_manaused_27" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26">
    							<span class="checked"></span>
    							</button>
    							<button title="28" type="action" name="act_manaused_28" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26 mt-27">
    							<span class="checked"></span>
    							</button>
    							<button title="29" type="action" name="act_manaused_29" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26 mt-27 mt-28">
    							<span class="checked"></span>
    							</button>
    							<button title="30" type="action" name="act_manaused_30" class="mdot mt-0 mt-1 mt-2 mt-3 mt-4 mt-5 mt-6 mt-7 mt-8 mt-9 mt-10 mt-11 mt-12 mt-13 mt-14 mt-15 mt-16 mt-17 mt-18 mt-19 mt-20 mt-21 mt-22 mt-23 mt-24 mt-25 mt-26 mt-27 mt-28 mt-29">
    							<span class="checked"></span>
    							</button>
							<label><button type="action" name="act_mp_reset" class="mp_reset">Refresh!</button></label>
						</div>
				</div>					
			<div class="mana elementalistmana">
				<label><span name="attr_secondaryelement" ></span> Element Max <input class="fourshorttextinput" type="number" name="attr_2maxmp" value="0" /></label>
				<label><span name="attr_secondaryelement" ></span> Magic Points Used: </label>
				<div class="dots">
					<input type="hidden" name="attr_secmanaused" class="m2dot" value="0" />
					<input type="hidden" name="attr_2maxmp" class="m2body" value="1" /> 
					<button title="1" type="action" name="act_secmanaused_1" class="m2dot mt2-0">
						<span class="checked"></span>
						</button>
						<button title="2" type="action" name="act_secmanaused_2" class="m2dot mt2-0 mt2-1">
						<span class="checked"></span>
						</button>
						<button title="3" type="action" name="act_secmanaused_3" class="m2dot mt2-0 mt2-1 mt2-2">
						<span class="checked"></span>
						</button>
						<button title="4" type="action" name="act_secmanaused_4" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3">
						<span class="checked"></span>
						</button>
						<button title="5" type="action" name="act_secmanaused_5" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4">
						<span class="checked"></span>
						</button>
						<button title="6" type="action" name="act_secmanaused_6" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5">
						<span class="checked"></span>
						</button>    
						<button title="7" type="action" name="act_secmanaused_7" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6">
						<span class="checked"></span>
						</button>    
						<button title="8" type="action" name="act_secmanaused_8" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7">
						<span class="checked"></span>
						</button>
						<button title="9" type="action" name="act_secmanaused_9" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8">
						<span class="checked"></span>
						</button> 
						<button title="10" type="action" name="act_secmanaused_10" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9">
						<span class="checked"></span>
						</button>
						<button title="11" type="action" name="act_secmanaused_11" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10">
						<span class="checked"></span>
						</button>
						<button title="12" type="action" name="act_secmanaused_12" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11">
						<span class="checked"></span>
						</button>
						<button title="13" type="action" name="act_secmanaused_13" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12">
						<span class="checked"></span>
						</button>
						<button title="14" type="action" name="act_secmanaused_14" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13">
						<span class="checked"></span>
						</button>
						<button title="15" type="action" name="act_secmanaused_15" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14">
						<span class="checked"></span>
						</button>
						<button title="16" type="action" name="act_secmanaused_16" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15">
						<span class="checked"></span>
						</button>
						<button title="17" type="action" name="act_secmanaused_17" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16">
						<span class="checked"></span>
						</button>
						<button title="18" type="action" name="act_secmanaused_18" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16 mt2-17">
						<span class="checked"></span>
						</button>
						<button title="19" type="action" name="act_secmanaused_19" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16 mt2-17 mt2-18">
						<span class="checked"></span>
						</button>
						<button title="20" type="action" name="act_secmanaused_20" class="m2dot mt2-0 mt2-1 mt2-2 mt2-3 mt2-4 mt2-5 mt2-6 mt2-7 mt2-8 mt2-9 mt2-10 mt2-11 mt2-12 mt2-13 mt2-14 mt2-15 mt2-16 mt2-17 mt2-18 mt2-19">
						<span class="checked"></span>
						</button>
				<label><button type="action" name="act_secmp_reset" class="mp_reset">Refresh!</button></label> 
				</div>
			<label><span name="attr_tertiaryelement" ></span> Element Max <input class="fourshorttextinput" type="number" name="attr_3maxmp" value="0" /></label>
			<label><span name="attr_tertiaryelement" ></span> Magic Points Used: </label>
				<div class="dots">
					<input type="hidden" name="attr_termanaused" class="m3dot" value="0" />
					<input type="hidden" name="attr_3maxmp" class="m3body" value="1" />
					<button title="1" type="action" name="act_termanaused_1" class="m3dot mt3-0">
						<span class="checked"></span>
						</button>
						<button title="2" type="action" name="act_termanaused_2" class="m3dot mt3-0 mt3-1">
						<span class="checked"></span>
						</button>
						<button title="3" type="action" name="act_termanaused_3" class="m3dot mt3-0 mt3-1 mt3-2">
						<span class="checked"></span>
						</button>
						<button title="4" type="action" name="act_termanaused_4" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3">
						<span class="checked"></span>
						</button>
						<button title="5" type="action" name="act_termanaused_5" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4">
						<span class="checked"></span>
						</button>
						<button title="6" type="action" name="act_termanaused_6" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5">
						<span class="checked"></span>
						</button>    
						<button title="7" type="action" name="act_termanaused_7" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6">
						<span class="checked"></span>
						</button>    
						<button title="8" type="action" name="act_termanaused_8" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7">
						<span class="checked"></span>
						</button>
						<button title="9" type="action" name="act_termanaused_9" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8">
						<span class="checked"></span>
						</button> 
						<button title="10" type="action" name="act_termanaused_10" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9">
						<span class="checked"></span>
						</button>
						<button title="11" type="action" name="act_termanaused_11" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10">
						<span class="checked"></span>
						</button>
						<button title="12" type="action" name="act_termanaused_12" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11">
						<span class="checked"></span>
						</button>
						<button title="13" type="action" name="act_termanaused_13" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12">
						<span class="checked"></span>
						</button>
						<button title="14" type="action" name="act_termanaused_14" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13">
						<span class="checked"></span>
						</button>
						<button title="15" type="action" name="act_termanaused_15" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14">
						<span class="checked"></span>
						</button>
						<button title="16" type="action" name="act_termanaused_16" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15">
						<span class="checked"></span>
						</button>
						<button title="17" type="action" name="act_termanaused_17" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16">
						<span class="checked"></span>
						</button>
						<button title="18" type="action" name="act_termanaused_18" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16 mt3-17">
						<span class="checked"></span>
						</button>
						<button title="19" type="action" name="act_termanaused_19" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16 mt3-17 mt3-18">
						<span class="checked"></span>
						</button>
						<button title="20" type="action" name="act_termanaused_20" class="m3dot mt3-0 mt3-1 mt3-2 mt3-3 mt3-4 mt3-5 mt3-6 mt3-7 mt3-8 mt3-9 mt3-10 mt3-11 mt3-12 mt3-13 mt3-14 mt3-15 mt3-16 mt3-17 mt3-18 mt3-19">
						<span class="checked"></span>
						</button> 
				<label><button type="action" name="act_termp_reset" class="mp_reset">Refresh!</button></label>                    

				</div>
				<label></label>
			</div>  		
			<div class="mana mysticmana">
				<label class="boxheading">Mystic Magic </label>
					<label>Psychic Fatigue Check: <br><input class="fourshorttextinput" type="number" name="attr_pfc" value="0" /> - spell level </label>
					<label>ESP <input class="fourshorttextinput" type="number" name="attr_espchance" value="0" />%</label>
					<label>Premonition <input class="fourshorttextinput" type="number" name="attr_premonitionchance" value="0" />%</label>

			</div>
		
		</div>
			<div class="spellbox">
				<input type="hidden" class="profession-toggle" name="attr_profession" value="0" /> 
				<div class="spells list">
					<label>Spells of Rank 1</label>
					<fieldset class="repeating_SpellsRankOne"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 2</label>
					<fieldset class="repeating_SpellsRankTwo"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 3</label>
					<fieldset class="repeating_SpellsRankThree"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 4</label>
					<fieldset class="repeating_SpellsRankFour"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 5</label>
					<fieldset class="repeating_SpellsRankFive"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 6</label>
					<fieldset class="repeating_SpellsRankSix"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 7</label>
					<fieldset class="repeating_SpellsRankSeven"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 8</label>
					<fieldset class="repeating_SpellsRankEight"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 9</label>
					<fieldset class="repeating_SpellsRankNine"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
					<label>Spells of Rank 10</label>
					<fieldset class="repeating_SpellsRankTen"> 
						Name <input class="sixteenlongtextinput" type="text" name="attr_SpellName" value="None" />
						Range <input class="eightmidtextinput" type="text" name="attr_SpellRange" value="0" />
						Duration <input class="sixteenlongtextinput" type="text" name="attr_SpellDuration" value="0" /><br>
						Description<br> <textarea name="attr_SpellDescription"></textarea>
					</fieldset>
				 </div>
			 </div>
	</div>

	<div class="skills">
		<div class="professionskills">
			<label class="boxheading" >Profession Skills </label>
			<fieldset class="repeating_professionskills"> 
				Skill <input class="sixteenlongtextinput" type="text" name="attr_professionskill" value="None" />
				Description <br> <textarea name="attr_professionskilldescription"> </textarea>
			</fieldset>
		</div>
		<div class="secondaryskillssec">
			<label class="boxheading" >Secondary Skills </label>
			<fieldset class="repeating_secondaryskills">
				Skill <input class="sixteenlongtextinput" type="text" name="attr_secondaryskill" value="None" />
				Level <select name="attr_secondaryskilllevel">
					<option value="None" selected>(Pick One)</option>
					<option value="Basic">Basic</option>
					<option value="Intermediate">Intermediate</option>
					<option value="Advanced">Advanced</option>
				</select><br>
				Description <br> <textarea name="attr_csecondaryskilldescription"> </textarea>
			</fieldset>
		</div>
	</div>

	<div class="languages">
    	<div class="modlang">
			<label class="boxheading" >Modern Languages</label>
			<fieldset class="repeating_modernlanguages"> 
				Language <select name="attr_modernlanguage">
					<option value="Blank" selected>(Pick One)</option>
					<option value="Elleslandic"> Elleslandic</option>
					<option value="Visic"> Visic</option>
					<option value="Latter Mercanian"> Latter Mercanian</option>
					<option value="LCabbandari"> Low Cabbandari</option>
					<option value="HCabbandari"> High Cabbandari</option>
					<option value="Dakkandi"> Dakkandi</option>
					<option value="Algandarve"> Algandarve</option>
					<option value="Angate"> Angate</option>
					<option value="Beaulangue"> Beaulangue</option>
					<option value="Kurlish"> Kurlish</option>
					<option value="MEmphidian"> Modern Emphidian</option>
					<option value="Opalarian"> Opalarian</option>
					<option value="Nascerine"> Nascerine</option>
					<option value="Etyabeyely"> Et'ya'be'yely</option>
					<option value="Klav"> Klav</option>
					<option value="Unno"> Unno</option>
					<option value="Raukil"> Raukil</option>
					<option value="Tsutsuneng"> Tsutsuneng</option>
					<option value="Coradian"> Coradian Trader's Argot</option>
					<option value="Arcane"> Arcane</option>
				</select>
				Fluency Level <select name="attr_modernfluency"> 
					<option value="None" selected>(Pick One)</option>
					<option value="Fluent">Fluent</option>
					<option value="Intermediate">Intermediate</option>
					<option value="Basic">Basic</option>
				</select>
				Literate? <input type="checkbox" name="attr_modernliterate" value="1" />
				Script <select name="attr_modernwriting"> 
					<option value="None" selected>(Pick One)</option>
					<option value="Classic"> Classic</option>
					<option value="Nikkar Runic"> Nikkar Runic</option>
					<option value="Emphidian"> Emphidian</option>
					<option value="Jezant"> Jezant</option>
					<option value="Majestic"> Majestic</option>
					<option value="Kitai Pictograms"> Kitai Pictograms</option>
				</select>
			</fieldset>
		</div>
		<div class="anclang">
			<label class="boxheading" >Ancient Languages</label>
				<fieldset class="repeating_ancientlanguages"> 
				Language <select name="attr_ancientlanguage">
					<option value="None" selected> (Pick One)</option>
					<option value="Bacchile"> Bacchile</option>
					<option value="AEmphidian"> Ancient Emphidian</option>
					<option value="Old Mercanian"> Old Mercanian</option>
					<option value="Old Kurlish"> Old Kurlish</option>
					<option value="Kaikahuran"> Ancient Kaikahuran</option>
					<option value="Lughwyd"> Lughwyd</option>
				</select>
				Fluency Level <select name="attr_ancientfluency"> 
					<option value="None" selected> (Pick One)</option>
					<option value="Fluent">Fluent</option>
					<option value="Intermediate">Intermediate</option>
					<option value="Basic">Basic</option>
				</select>
				Literate? <input type="checkbox" name="attr_ancientliterate" value="1" />
				Script <select name="attr_ancientwriting"> 
					<option value="None" selected> (Pick One)</option>
					<option value="Classic"> Classic</option>
					<option value="Nikkar Runic"> Nikkar Runic</option>
					<option value="Emphidian"> Emphidian</option>
					<option value="Jezant"> Jezant</option>
					<option value="Qemor Heiroglyphs"> Qemor Heiroglyphs</option>
					<option value="Kell"> Kell</option>
					<option value="Majestic"> Majestic</option>
					<option value="Kitai Pictograms"> Kitai Pictograms</option>
				</select>
			</fieldset>
		</div>
    </div>
	<div class="biographical">
		<div class="basicbio">
			<label class="boxheading" >Physical and Biographical Details</label>
			<label>Gender <input class="eightmidtextinput" name="attr_gender" type="text" value="None" /></label>
			<label>Age <input class="fourshorttextinput" name="attr_age" type="number" value="0" /></label>
			<label>Height <input class="fourshorttextinput" name="attr_height" type="text" value="None" /></label>
			<label>Build <input class="sixteenlongtextinput" name="attr_build" type="text" value="None" /></label>
			<label>Eye Colour <input class="eightmidtextinput" name="attr_eyes" type="text" value="None" /></label>
			<label>Hair colour / Style <input class="sixteenlongtextinput" name="attr_hair" type="text" value="None" /></label>
			<label>Origin Country <input class="sixteenlongtextinput" name="attr_origin" type="text" value="None" /></label>
			<label>Family Background <input class="sixteenlongtextinput" name="attr_familybackground" type="text" value="None" /></label>
			<label>Description <textarea name="attr_description"></textarea></label>
			<label>Biography <textarea name="attr_biography"></textarea></label>
		</div>
	</div>

	<div class="documentation">
		This character sheet includes material based on the Dragon Warriors setting, as created by and copyright (c) Dave Morris and Oliver Johnson, and used according to the terms of the Serpent King Games Fan Policy. We are not permitted to charge you to use or access this content. This character sheet is not published, endorsed, or officially approved by Serpent King Games. For more information about Dragon Warriors products and Serpent King Games, please visit www.serpentking.com<br>
		Serpent King Games expects you to use the Dragon Warriors setting responsibly and legally. That means avoiding associating the setting with extreme graphic violence, explicit sexual content, hate speech against any particular real-world segment of society, or anything else that does not present Dragon Warriors in a positive light.<br>
		If you have any questions about Dragon Warriors, or the conditions of use of this character sheet, please email info@serpentking.com<br><br>
		Most of the images used on the character sheet come directly from the Dragon Warriors books.<br><br>
		The image used to represent Magic Points named "effect" and was created by ATOM and sourced from the Noun Project.<br><br>
		A huge shoutout to Roll20 forums member GiGs, without whom this sheet would not have been built.<br><br>
		<label class="boxheading"> Release Notes</label>
		<label>Ver 1.2</label>
		Total Overhaul Update<br><br>
		<label>Fixed and Added:</label>
		Major changes to layout, and corrected font style for inputs<br>
		Added artworks<br>
		Corrected problems with Elementalist MP sections<br>
		Fixed issues with Mystic's Psychic Fatigue field<br>
		Added Combat page to track all changes to Attack and Defence scores through guards, profession abilities and equipment modifiers<br>
		Changed the button image on wounds and mana points trackers<br>
		Added wound counters to track Health Points down to -1, -2 and -3 (wounds tracker for Macros does not take these into account, but they are not relevant for KO/shock calculations anyway) <br>
		Added a magic bonus section to weapons and shields for applying bonuses to combat attributes.<br>
		Added 'equipped' value to weapons selection to ensure only a single weapon's magic bonuses applies at a time.<br>
		Modified the Armour Factor area to be more specific.<br>
		Added sheet rolls for attacks, attribute checks and other basic game roll functions<br>
		Further code stream-lining.<br>
		<br>
		<label>Ver 1.1</label>
		<label>Fixed and Added:</label>
		Missing Languages added and literacy checkbox default value fixed<br>
		Slight remodel of the front page to incorporate new elements<br>
		Sheet Worker now rounds off encumberance, and calculates total (including equipment, coins, weapons and shield) and maximum encumbrance values<br>
		Added a quantity field for inventory items<br>
		Added an ammunition section underneath the Weapons<br>
		Wounds checkboxes have been updated, the number of radioboxes available is set to equal a character's max HP. The sheet can calculate remaining HP based on the wounds counter.<br>
		Show/hide magic sections (front page and magic page) dependant on profession selected from the dropdown list<br>
		Major code tidy up<br>
		<br>
		<label>Bugs to work out:</label>
		None known, let me know if you see one so I can squash it!<br>
		<br>
		<label>Features still to add: </label>
	</div>
</div>

<script type="text/worker">
	const buttonlist = ["character","inventory","combat","magic","skills","languages","biographical","documentation"];
	buttonlist.forEach(button => {
		on(`clicked:${button}`, function() {
			setAttrs({
				sheetTab: button
			});
		});
	});

	on('change:specialammomodifier change:equippedammo change:equippedrangedwep change:equippedmeleewep change:shield change:attack change:defence change:magicammobonus change:magicrangedweaponbonus change:magicmeleeweaponbonus change:armourattackpenalty change:armourdefencepenalty change:magicshield change:miscattackmelee change:miscdefencemelee change:miscattackranged change:miscdefenceranged sheet:opened', function() {
		getAttrs(['specialammomodifier','shield','attack','defence','magicammobonus','magicrangedweaponbonus','magicmeleeweaponbonus','armourattackpenalty','armourdefencepenalty','magicshield','miscattackmelee','miscdefencemelee','miscattackranged','miscdefenceranged'], function(v) {
			let atk = parseInt(v.attack)||0;
			let def = parseInt(v.defence)||0;
			let ammo = parseInt(v.magicammobonus)||0;
			let specialammo = parseInt(v.specialammomodifier)||0;
			let ranged = parseInt(v.magicrangedweaponbonus)||0;
			let melee = parseInt(v.magicmeleeweaponbonus)||0;
			let armouratk = parseInt(v.armourattackpenalty)||0;
			let armourdef = parseInt(v.armourdefencepenalty)||0;
			let shieldequipped = parseInt(v.shield)||0;
			if (shieldequipped === 1) {
				shield = parseInt(v.magicshield)||0;}
			else {
				shield = 0;
			}
			let miscmeleea = parseInt(v.miscattackmelee)||0;
			let miscmeleed = parseInt(v.miscdefencemelee)||0;
			let miscrangeda = parseInt(v.miscattackranged)||0;
			let miscrangedd = parseInt(v.miscdefenceranged)||0;
			let basemeleeatk = (atk + melee - armouratk + miscmeleea);
			let basemeleedef = (def + melee - armourdef + shield + miscmeleed);
			let baserangedatk = (atk + ranged + ammo + specialammo - armouratk + miscrangeda);
			let baserangeddef= (def - armourdef + shield + miscrangedd);
			setAttrs({
				baserangedattack: baserangedatk,
				baserangeddefence: baserangeddef,
				basemeleeattack: basemeleeatk,
				basemeleedefence: basemeleedef
			});
		});
	});	
	
	on('change:mainguacheactive change:berserktoranged change:attack change:basemeleeattack change:basemeleedefence change:baserangedattack change:baserangeddefence change:defence change:rattackmodded change:rdefencemodded change:mattackmodded change:mdefencemodded change:berserkneg change:preciseneg change:stillnessneg change:bloodrageselect change:nonprofselect change:deathvowselect sheet:opened', function() {
		getAttrs(['mainguachedefence','mainguacheactive','berserktoranged','finalattack','finaldefence','basemeleedefence','basemeleeattack','baserangedattack','baserangeddefence','mdefencemodded','rattackmodded','rdefencemodded','mattackmodded','berserkneg','berserkpos','preciseneg','precisepos','stillnessneg','bloodrageselect','nonprofselect','deathvowselect'], function(v) {
			let bloodrage = parseInt(v.bloodrageselect) || 0;
			let berserkappliestoranged = parseInt(v.berserktoranged)||0;
			let mainguache = parseInt(v.mainguacheactive)||0;

			if (bloodrage === 1) {
				bloodragemod = parseInt(v.basemeleedefence) || 0;
				berserkattack = 0;
				berserkdefence = 0;
				mainguachedefence = 0;
				nonprofmod = 0;
				deathvowmod = 0;
				preciseattack = 0;
				precisedefence = 0;
				stillnessdefence = 0;
				mattackmod = parseInt(v.basemeleeattack)||0;
				mdefencemod= parseInt(v.basemeleedefence)||0;
				rattackmod = parseInt(v.baserangedattack)||0;
				rdefencemod = parseInt(v.baserangeddefence)||0;
			}
			else if (mainguache === 2) {
				mainguachedefence = parseInt(v.basemeleedefence) || 0;
				berserkattack = 0;
				berserkdefence = 0;
				mattackmod = parseInt(v.mattackmodded)||0;
				mdefencemod= parseInt(v.basemeleedefence)||0;
				rattackmod = parseInt(v.rattackmodded) || 0;
				rdefencemod = parseInt(v.rdefencemodded) || 0;
				nonprofmod = 0;
				deathvowmod = 0;
				preciseattack = 0;
				precisedefence = 0;
				stillnessdefence = 0;
			}
			else if (mainguache === 1) {
				berserkattack = 0;
				berserkdefence = 0;
				rattackmod = parseInt(v.rattackmodded) || 0;
				rdefencemod = parseInt(v.rdefencemodded) || 0;
				mattackmod = parseInt(v.mattackmodded)||0;
				mdefencemod = parseInt(v.mdefencemodded)||0;
				nonprofmod = 0;
				deathvowmod = 0;
				preciseattack = 0;
				precisedefence = 0;
				stillnessdefence = 0;
				mainguachedefence = -2;
			}
			else {
				bloodragemod = 0;
				berserkattack = parseInt(v.berserkpos) || 0;
				berserkdefence = parseInt(v.berserkneg) || 0;
				rattackmod = parseInt(v.rattackmodded) || 0;
				rdefencemod = parseInt(v.rdefencemodded) || 0;
				mattackmod = parseInt(v.mattackmodded)||0;
				mdefencemod = parseInt(v.mdefencemodded)||0;
				nonprofmod = parseInt(v.nonprofselect) || 0;
				deathvowmod = parseInt(v.deathvowselect) || 0;
				preciseattack = parseInt(v.precisepos) || 0;
				precisedefence = parseInt(v.preciseneg) || 0;
				stillnessdefence = parseInt(v.stillnessneg) || 0;
				mainguachedefence = 0;
			}

			let fmatk = (mattackmod + berserkattack - nonprofmod + deathvowmod + bloodragemod);
			let fmdef = (mdefencemod - berserkdefence - precisedefence - stillnessdefence - bloodragemod - mainguachedefence);
			
			if (berserkappliestoranged === 1) {
				fratk = (rattackmod + berserkattack - nonprofmod + deathvowmod + preciseattack)||0;
				frdef = (rdefencemod - berserkdefence - precisedefence - stillnessdefence)||0;
				}
			else {
				fratk = (rattackmod - nonprofmod + deathvowmod + preciseattack)||0;
				frdef = (rdefencemod - berserkdefence - precisedefence - stillnessdefence)||0;
				}

			setAttrs({                            
				finalmeleeattack: parseInt(fmatk)||0,
				finalmeleedefence: parseInt(fmdef)||0,
				finalrangedattack: parseInt(fratk)||0,
				finalrangeddefence: parseInt(frdef)||0,
			});
		});
	});	
	
		on('change:repeating_meleeweapons:equippedmeleewep', function(event) {
			if (event.sourceType === 'sheetworker' ) return;
			const playerclickedid = (event.sourceAttribute.split('_')[2] || '').toLowerCase(); 
			getSectionIDs('repeating_meleeweapons', function (ids) {
				const fieldnames = [];
				ids.forEach(id => fieldnames.push(
					`repeating_meleeweapons_${id}_equippedmeleewep`,
					`repeating_meleeweapons_${id}_magicmeleeweaponbonus`,
					`repeating_meleeweapons_${id}_meleeweapon`,
					`repeating_meleeweapons_${id}_meleeabr`,
					`repeating_meleeweapons_${id}_meleedamage`
		
				));
				getAttrs(fieldnames, values => {
					const output = {};
					ids.forEach(id => {
						const checkbox = parseInt(values[`repeating_meleeweapons_${id}_equippedmeleewep`]) || 0;
						const magicbonus = parseInt(values[`repeating_meleeweapons_${id}_magicmeleeweaponbonus`]) || 0;
						const meleeweaponname = (values[`repeating_meleeweapons_${id}_meleeweapon`]) || None;
						const meleeweaponabr = (values[`repeating_meleeweapons_${id}_meleeabr`]) || None;
						const meleeweapondam = (values[`repeating_meleeweapons_${id}_meleedamage`]) || None;
		
						if(id.toLowerCase() === playerclickedid) {
							output.magicmeleeweaponbonus = checkbox ? magicbonus : 0;
							output.meleeweapon = checkbox ? meleeweaponname : "None";
							output.meleeabr = checkbox ? meleeweaponabr : "0d0";
							output.meleedamage = checkbox ? meleeweapondam : "0d0";
		
						} else if(checkbox) {
							output[`repeating_meleeweapons_${id}_equippedmeleewep`] = 0;
						}
						setAttrs(output);
					});
				});
			});
		});
	
		on('change:repeating_rangedweapons:equippedrangedwep', function(event) {
			if (event.sourceType === 'sheetworker' ) return;
			const playerclickedid = (event.sourceAttribute.split('_')[2] || '').toLowerCase(); 
			getSectionIDs('repeating_rangedweapons', function (ids) {
				const fieldnames = [];
				ids.forEach(id => fieldnames.push(
					`repeating_rangedweapons_${id}_equippedrangedwep`,
					`repeating_rangedweapons_${id}_magicrangedweaponbonus`,
					`repeating_rangedweapons_${id}_rangedweapon`,
					`repeating_rangedweapons_${id}_rangedabr`,
					`repeating_rangedweapons_${id}_rangeddamage`,
					`repeating_rangedweapons_${id}_weaponshortrange`,
					`repeating_rangedweapons_${id}_weaponmediumrange`,
					`repeating_rangedweapons_${id}_weaponlongrange`
	
				));
				getAttrs(fieldnames, values => {
					const output = {};
					ids.forEach(id => {
						const checkbox = parseInt(values[`repeating_rangedweapons_${id}_equippedrangedwep`]) || 0;
						const magicbonus = parseInt(values[`repeating_rangedweapons_${id}_magicrangedweaponbonus`]) || 0;
						const rangedweaponname = (values[`repeating_rangedweapons_${id}_rangedweapon`]) || None;
						const rangedweaponabr = (values[`repeating_rangedweapons_${id}_rangedabr`]) || None;
						const rangedweapondam = (values[`repeating_rangedweapons_${id}_rangeddamage`]) || None;
						const shortrange = (values[`repeating_rangedweapons_${id}_weaponshortrange`]) || None;
						const mediumrange = (values[`repeating_rangedweapons_${id}_weaponmediumrange`]) || None;
						const longrange = (values[`repeating_rangedweapons_${id}_weaponlongrange`]) || None;
	
						if(id.toLowerCase() === playerclickedid) {
							output.magicrangedweaponbonus = checkbox ? magicbonus : 0;
							output.rangedweapon = checkbox ? rangedweaponname : "None";
							output.rangedabr = checkbox ? rangedweaponabr : "0d0";
							output.rangeddamage = checkbox ? rangedweapondam : "0d0";
							output.weaponshortrange = checkbox ? shortrange : 0;
							output.weaponmediumrange = checkbox ? mediumrange : 0;
							output.weaponlongrange = checkbox ? longrange : 0;
	
						} else if(checkbox) {
							output[`repeating_rangedweapons_${id}_equippedrangedwep`] = 0;
						}
						setAttrs(output);
					});
				});
			});
		});
		
		on('change:repeating_ammo:equippedammo', function(event) {
			if (event.sourceType === 'sheetworker' ) return;
			const playerclickedid = (event.sourceAttribute.split('_')[2] || '').toLowerCase(); 
			getSectionIDs('repeating_ammo', function (ids) {
				const fieldnames = [];
				ids.forEach(id => fieldnames.push(
					`repeating_ammo_${id}_equippedammo`,
					`repeating_ammo_${id}_magicammobonus`,
					`repeating_ammo_${id}_specialammomodifier`,
					`repeating_ammo_${id}_specialammoabrmodifier`,
					`repeating_ammo_${id}_specialammodmgmodifier`,
					`repeating_ammo_${id}_ammotype`

				));
				getAttrs(fieldnames, values => {
					const output = {};
					ids.forEach(id => {
						const checkbox = parseInt(values[`repeating_ammo_${id}_equippedammo`]) || 0;
						const magicbonus = parseInt(values[`repeating_ammo_${id}_magicammobonus`]) || 0;
						const specialammomodifier = parseInt(values[`repeating_ammo_${id}_specialammomodifier`]) || 0;
						const specialammoabrmodifier = parseInt(values[`repeating_ammo_${id}_specialammoabrmodifier`]) || 0;
						const specialammodmgmodifier = parseInt(values[`repeating_ammo_${id}_specialammodmgmodifier`]) || 0;
						const ammo = (values[`repeating_ammo_${id}_ammotype`]) || 0;
		
						if(id.toLowerCase() === playerclickedid) {
							output.magicammobonus = checkbox ? magicbonus : 0;
							output.specialammomodifier = checkbox ? specialammomodifier : 0;
							output.specialammoabrmodifier = checkbox ? specialammoabrmodifier : 0;
							output.specialammodmgmodifier = checkbox ? specialammodmgmodifier : 0;
							output.ammotype = checkbox ? ammo : "None";
		
						} else if(checkbox) {
							output[`repeating_ammo_${id}_equippedammo`] = 0;
						}
						setAttrs(output);
					});
				});
			});
		});
				
		on('change:strength', function() {  
			getAttrs(['strength','meleedmgbonus','meleeabrbonus'], function(value) {

				let str = parseInt(value.strength)||0;
				let maxenc = parseInt(value.maxenc)||0;
				let meleeabrbonus = parseInt(value.meleeabrbonus)||0;
				let meleedmgbonus = parseInt(value.meleeadmgbonus)||0;

				if (str < 5) {
					maxenc = 6;
					meleeabrbonus = 0;
					meleedmgbonus = 0;
					} 
				else if (str < 8) {
					maxenc = 8;
					meleeabrbonus = 0;
					meleedmgbonus = 0;
					} 
				else if (str < 12) {
					maxenc = 10;
					meleeabrbonus = 0;
					meleedmgbonus = 0;
					} 
				else if (str < 15) {
					maxenc = 12;
					meleeabrbonus = 0;
					meleedmgbonus = 0;
					} 
				else if (str < 18) {
					maxenc = 14;
					meleeabrbonus = 1;
					meleedmgbonus = 1;
					}
				else {
					maxenc = 14;
					meleeabrbonus = 2;
					meleedmgbonus = 2;	
					}

				setAttrs({                            
					meleeabrbonus: meleeabrbonus,
					meleedmgbonus: meleedmgbonus,
					maxenc: maxenc 
					});
				});
			});
						  	
		on('change:armourpiercingselect change:masterbowmanselect change:penetratingshotmultiplier change:penetratingshotselect change:weaponskillselect change:shield change:expertparryselect change:guardcountered change:guardcurrent change:attack change:defence change:basemeleeattack change:basemeleedefence change:baserangedattack change:baserangeddefence change:evasion sheet:opened', function() {
			getAttrs(['armourpiercingselect','armourpiercingmodifier','masterbowmanselect','masterbowmanmodifier','penetratingshotmultiplier','penetratingshotselect','weaponskillselect','weaponskillabrmodifier','guardabrmodifier','guarddamagemodifier','shield','expertparryselect','shieldsuccessvalue','shielddievalue','guardcountered','basemeleeattack','basemeleedefence','baserangedattack','baserangeddefence','evasion','guardcurrent'], function(value) {
				
				const forms = {
					Hawk: {mattackmodded: 1, mdefencemodded: -2, rattackmodded: 1, rdefencemodded: -2, evasionmodded: 0, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "If wielding a two-handed weapon: -1 Evasion and +1 Armour Penetration (please adjust manually"},
					Snake: {mattackmodded: 1, mdefencemodded: -3, rattackmodded: 1, rdefencemodded: -3, evasionmodded: 0, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "Critical Hits do +1 HP damage (please adjust manually)"},
					Wolf: {mattackmodded: 2, mdefencemodded: -3, rattackmodded: 2, rdefencemodded: -3, evasionmodded: -1, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "None"},
					Bear: {mattackmodded: -2, mdefencemodded: 1, rattackmodded: -2, rdefencemodded: 1, evasionmodded: 0, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "+1 additional Defence for each opponent beyond the first (Please enter in the Miscelaneous Modifiers Section manually)"},
					Cat: {mattackmodded: -2, mdefencemodded: 1, rattackmodded: -2, rdefencemodded: 1, evasionmodded: 1, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "If using a shield: an additional -1 Attack and Shields block on a roll of 1 on 1d4 (these adjustments have been made for you)"},
					Crab: {mattackmodded: -2, mdefencemodded: 2, rattackmodded: -2, rdefencemodded: 2, evasionmodded: 0, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "None"},
					Neutral: {mattackmodded: 0, mdefencemodded: 0, rattackmodded: 0, rdefencemodded: 0, evasionmodded: 0, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "None"},
					Defensive: {mattackmodded: -2, mdefencemodded: 1, rattackmodded: -2, rdefencemodded: 1, evasionmodded: 1, guarddamagemodifier: -1, guardabrmodifier: -1, othermodifications: "-1 Damage and -1 Armour Penetration (these adjustments have been made for you)"},
					Offensive: {mattackmodded: 1, mdefencemodded: -2, rattackmodded: 1, rdefencemodded: -2, evasionmodded: -1, guarddamagemodifier: 0, guardabrmodifier: 0, othermodifications: "None"}
				};
	
				let guac = parseInt(value.guardcountered)||0;
				let gua = value.guardcurrent || 'Neutral';
				const output = forms[gua] || forms.Neutral;
				let shieldeq = parseInt(value.shield)||0;
				let shielddie = (value.shielddievalue)||'1d6';
				let shieldsuccess = parseInt(value.shieldsuccessvalue)||1;
				let expertparry = parseInt(value.expertparryselect)||0;
				let weaponskill = parseInt(value.weaponskillselect)||0;
				let penetratingshot = parseInt(value.penetratingshotselect)||0;
				let str = parseInt(value.strength)||0;
				let masterbowman = parseInt(value.masterbowmanselect)||0;
				let armourpiercing = parseInt(value.armourpiercingselect)||0;

				if (masterbowman === 1) {
					output.masterbowmanmodifier = 1 || 0;
				}
				else {
					output.masterbowmanmodifier = 0 || 0;
				}

				if (armourpiercing === 1) {
					output.armourpiercingmodifier = 1 || 0;
				}
				else {
					output.armourpiercingmodifier = 0;
				}

				if (weaponskill === 1) {
					output.weaponskillabrmodifier = 1 || 0;
				}
				else {
					output.weaponskillabrmodifier = 0;
				}

				if (penetratingshot === 1) {
					output.penetratingshotabrmodifier = parseInt(value.penetratingshotmultiplier) || 0;
				}
				else {
					output.penetratingshotabrmodifier = 0;
				}

				if (gua === "Cat") {
					shielddie = '1d4';
					shieldsuccess = 1;
				}
				else if (expertparry === 1) {
					shielddie = '1d10';
					shieldsuccess = 2;
				}
				else {
					shielddie = '1d6';
					shieldsuccess = 1;
				}
			
				if (guac === 1 && gua !== "Neutral") {
					if (gua === "Hawk" || gua === "Snake" || gua === "Wolf") {
						output.mattackmodded += (parseInt(value.basemeleeattack)-2) || 0;
						output.mdefencemodded += parseInt(value.basemeleedefence) || 0;
						output.rattackmodded += (parseInt(value.baserangedattack)-2) || 0;
						output.rdefencemodded += parseInt(value.baserangeddefence) || 0;
						}
						else if (gua === "cat" && shieldeq === 1) {
						output.mattackmodded += (parseInt(value.basemeleeattack)-1) || 0;
						output.mdefencemodded += (parseInt(value.basemeleedefence)-2) || 0;
						output.rattackmodded += parseInt(value.baserangedattack)-1 || 0;
						output.rdefencemodded += (parseInt(value.baserangeddefence)-2) || 0;
						}
						else {
						output.mattackmodded += parseInt(value.basemeleeattack) || 0;
						output.mdefencemodded += (parseInt(value.basemeleedefence)-2) || 0;
						output.rattackmodded += parseInt(value.baserangedattack) || 0;
						output.rdefencemodded += (parseInt(value.baserangeddefence)-2) || 0;
						}   	    
					}     
				else if (gua === "Cat" && shieldeq === 1) {
					output.mattackmodded += (parseInt(value.basemeleeattack)-1) || 0;
					output.mdefencemodded += parseInt(value.basemeleedefence) || 0;
					output.rattackmodded += (parseInt(value.baserangedattack)-1) || 0;
					output.rdefencemodded += parseInt(value.baserangeddefence) || 0;    
					}
				else {
					output.mattackmodded += parseInt(value.basemeleeattack) || 0;
					output.mdefencemodded += parseInt(value.basemeleedefence) || 0;
					output.rattackmodded += parseInt(value.baserangedattack) || 0;
					output.rdefencemodded += parseInt(value.baserangeddefence) || 0;    
					}

				output.evasionmodded += parseInt(value.evasion) || 0;
				output.othermodifications = (value.othermodifications) || "None";
				output.shielddievalue = shielddie;	
				output.shieldsuccessvalue = shieldsuccess;	  
				
				setAttrs(output);
			});
			});

	on('change:mdefencemodded  change:berserkneg ', () => {
		getAttrs(['berserkneg', 'mdefencemodded', 'rdefencemodded'], v=> {
			const stats = ['berserk'];
			const output = {};
			const mdef = parseInt(v.mdefencemodded) || 0;
			const rdef = parseInt(v.rdefencemodded) || 0;
			stats.forEach(stat => {
				let neg = parseInt(v[`${stat}neg`]) || 0; 
				let score = (neg > mdef || neg > rdef) ? Math.max(mdef, rdef) : (neg < 0 ? 0 : neg);
				let factor = 3;
				let pos = Math.floor(score / factor);
				output[`${stat}neg`] = Math.floor(score/factor)*factor;
				output[`${stat}pos`] = pos;
			});
			setAttrs(output, {silent:true});
		});
	});

	on('change:rdefencemodded change:preciseneg change:stilnessneg', () => {
		getAttrs(['preciseneg', 'stillnessneg','rdefencemodded'], v=> {
			const stats = ['precise', 'stillness'];
			const output = {};
			const mdef = parseInt(v.rdefencemodded) || 0;
			stats.forEach(stat => {
				let neg = parseInt(v[`${stat}neg`]) || 0; 
				let score = (neg > rdef) ? rdef : (neg < 0 ? 0 : neg);
				let factor = (stat === 'stillness') ? 2 : 3;
				let pos = Math.floor(score / factor);
				output[`${stat}neg`] = Math.floor(score/factor)*factor;
				output[`${stat}pos`] = pos;
			});
			setAttrs(output, {silent:true});
		});
	});
		
	on('change:guardstomeleeonly change:attack change:basemeleeattack change:basemeleedefence change:baserangedattack change:baserangeddefence change:defence change:mattackmodded change:mdefencemodded change:rattackmodded change:rdefencemodded change:berserkneg change:preciseneg change:stillnessneg change:bloodrageselect change:nonprofselect change:deathvowselect sheet:opened', function() {
		getAttrs(['guardstomeleeonly','finalattack','finaldefence','basemeleedefence','basemeleeattack','baserangedattack','baserangeddefence','rdefencemodded','rattackmodded', 'mdefencemodded','mattackmodded','berserkneg','berserkpos','preciseneg','precisepos','stillnessneg','bloodrageselect','nonprofselect','deathvowselect'], function(v) {
			let bloodrage = parseInt(v.bloodrageselect)||0;
			let restrictedguards = parseInt(v.guardstomeleeonly)||0;

			if (restrictedguards === 1) {
				rattackmod = parseInt(v.baserangedattack)||0;
				rdefencemod = parseInt(v.baserangeddefence)||0;
				mattackmod = parseInt(v.mattackmodded)||0;
				mdefencemod = parseInt(v.mdefencemodded)||0;
				nonprofmod = parseInt(v.nonprofselect) || 0;
				deathvowmod = parseInt(v.deathvowselect) || 0;
				preciseattack = parseInt(v.precisepos) || 0;
				precisedefence = parseInt(v.preciseneg) || 0;
				stillnessdefence = parseInt(v.stillnessneg) || 0;
				}
			else if (bloodrage === 1) {
				bloodragemod = parseInt(v.basemeleedefence) || 0;
				berserkattack = 0;
				berserkdefence = 0;
				mattackmod = parseInt(v.basemeleeattack)||0;
				mdefencemod= parseInt(v.basemeleedefence)||0;
				rattackmod = parseInt(v.baserangedattack)||0;
				rdefencemod = parseInt(v.baserangeddefence)||0;
				}
			else {
				mattackmod = parseInt(v.mattackmodded) || 0;
				mdefencemod = parseInt(v.mdefencemodded) || 0;
				rattackmod = parseInt(v.rattackmodded) || 0;
				rdefencemod = parseInt(v.rdefencemodded) || 0;
				bloodragemod = 0;
				berserkattack = parseInt(v.berserkpos) || 0;
				berserkdefence = parseInt(v.berserkneg) || 0;
				nonprofmod = parseInt(v.nonprofselect) || 0;
				deathvowmod = parseInt(v.deathvowselect) || 0;
				preciseattack = parseInt(v.precisepos) || 0;
				precisedefence = parseInt(v.preciseneg) || 0;
				stillnessdefence = parseInt(v.stillnessneg) || 0;
				}
	
			let fmatk = mattackmod + berserkattack - nonprofmod + deathvowmod + bloodragemod;
			let fmdef = mdefencemod - berserkdefence - precisedefence - stillnessdefence - bloodragemod;
			let fratk = rattackmod + berserkattack - nonprofmod + deathvowmod + preciseattack;
			let frdef = rdefencemod - berserkdefence - precisedefence - stillnessdefence;
			
			setAttrs({                            
				finalmeleeattack: parseInt(fmatk)||0,
				finalmeleedefence: parseInt(fmdef)||0,
				finalrangedattack: parseInt(fratk)||0,
				finalrangeddefence: parseInt(frdef)||0
	
				});
		});
		});	
		
	const woundValues = ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"];
	  woundValues.forEach(function(value) {
		on(`clicked:wound_${value}`, function() {
		  setAttrs({
			wtwound: 0,
			wound: value
			});
		});
	});
	
	const wtwoundValues = ["0","1","2","3"];
	wtwoundValues.forEach(function(value) {
		on(`clicked:wtwound_${value}`, function() {
			getAttrs(["maxhp","wound"], function(v) {    
			let w1= parseInt(v.wound);
			let m1= parseInt(v.maxhp);
				if (w1 < m1) 
					wou = m1,
					wtw = value;
				else
					wtw = value;
	  setAttrs({
	  wtwound: wtw,
	  wound: wou
	});
	});
	});
	});
						
	const manausedValues = ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"];
	  manausedValues.forEach(function(value) {
		on(`clicked:manaused_${value}`, function() {
		  setAttrs({
			manaused: value
			});
		});
	});
	
	const secmanausedValues = ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"];
	  secmanausedValues.forEach(function(value) {
		on(`clicked:secmanaused_${value}`, function() {
		  setAttrs({
			secmanaused: value
			});
		});
	});
	
	const termanausedValues = ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"];
	  termanausedValues.forEach(function(value) {
		on(`clicked:termanaused_${value}`, function() {
		  setAttrs({
			termanaused: value
			});
		});
	});
	
	on("clicked:wound_reset", function() {
		setAttrs({
			wound: 0,
			wtwound: 0
		});
	});
	
	on("clicked:mp_reset", function() {
		setAttrs({
			manaused: 0
		});
	});
	
	on("clicked:secmp_reset", function() {
		setAttrs({
			secmanaused: 0
		});
	});
	
	on("clicked:termp_reset", function() {
		setAttrs({
			termanaused: 0
		});
	});    
	
	const repeatingSum = (destinations, section, fields, ...extras) => {
		const isNumber = value => parseFloat(value).toString() === value.toString();
		const isOption = value => [...checks.valid, ...checks.roundtypes].includes(value);
		const isRounding = value => checks.roundtypes.includes(value);
		const isFraction = value => value.includes('/') && !(value.includes(',') || value.includes('|'));
		const getTrimmed = value => value.toLowerCase().replace(/\s/g, '');
		const getRounded = (type, value, pow) => (Math[type](value * Math.pow(10, pow)) / Math.pow(10, pow)).toFixed(Math.max(0, pow));
		const getFraction = (value) => /*{ console.log(`value: ${value}`); */
			parseInt(value.split('/')[0]) / parseInt(value.split('/')[1]);
		const getMultiplier = (value, rounding = 1) => 'undefined' === typeof value ? (rounding ? 0: 1) : (
			isNumber(value) ? parseFloat(value) : (isFraction(value) ? getFraction(value) : value));
		if (!Array.isArray(destinations)) destinations = [getTrimmed(destinations)];
		if (!Array.isArray(fields)) fields = [getTrimmed(fields)];
		const fields_trimmed = fields.map(field => getTrimmed(field).split(':')[0]);
		const subfields = fields_trimmed.slice(0,destinations.length);
		const checks = { valid: ['multiplier'], roundtypes: ['ceil', 'round', 'floor'] };
		let properties = {attributes: {}, options: {}};
		extras.forEach(extra => {
			const [prop, v] = getTrimmed(extra).split(':');
			const multiplier_maybe = getMultiplier(v, isRounding(prop));
			const obj = isNumber(multiplier_maybe) ? subfields.reduce((obj,field) => {
				obj[field] = multiplier_maybe;
				return obj;
			},{}) : multiplier_maybe.split(',').reduce((obj, item) => {
				const [stat, value] = item.split('|');
				const multiplier = getMultiplier(value, isRounding(prop));
				obj[stat] = multiplier;
				return obj;
			}, {});
			properties[isOption(prop) ? 'options' : 'attributes'][prop] = obj;
		});
		getSectionIDs(`repeating_${section}`, idArray => {
			const attrArray = idArray.reduce((m, id) => [...m, ...(fields_trimmed.map(field => `repeating_${section}_${id}_${field}`))], []);
			getAttrs([...attrArray, ...Object.keys(properties.attributes)], v => {
				const getValue = (section, id, field) => v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : parseFloat(v[`repeating_${section}_${id}_${field}`]) || 0;
				const commonMultipliers = (fields.length <= destinations.length) ? [] : fields.splice(destinations.length, fields.length - destinations.length);
				const output = destinations.reduce((obj, destination, index) => {
					let sumTotal = idArray.reduce((total, id) => total + getValue(section, id, fields_trimmed[index]) * commonMultipliers.reduce((subtotal, mult) => subtotal * ((!mult.includes(':') || mult.split(':')[1].split(',').includes(fields_trimmed[index])) ? getValue(section, id, mult.split(':')[0]) : 1), 1), 0);
					sumTotal *= (properties.options.hasOwnProperty('multiplier') && Object.keys(properties.options.multiplier).includes(fields_trimmed[index])) ? (parseFloat(properties.options.multiplier[fields_trimmed[index]]) || 0): 1;
					sumTotal += Object.entries(properties.attributes).reduce((total, [key, value]) => 
						total += (value.hasOwnProperty(fields_trimmed[index]) ? parseFloat(v[key] || 0) * (parseFloat(value[fields_trimmed[index]]) || 1): 0) , 0);
					checks.roundtypes.forEach(type => {
						if (properties.options.hasOwnProperty(type)) {
							if (Object.keys(properties.options[type]).includes(fields_trimmed[index])) {
								sumTotal = getRounded(type, sumTotal, (+properties.options[type][fields_trimmed[index]] || 0));
							} else if (properties.options[type] == '0' || !isNaN(+properties.options[type] || 'x') ) {
								sumTotal = getRounded(type, sumTotal, +properties.options[type]);
							} 
						} 
					});
					obj[destination] = sumTotal;
					return obj;
				}, {});
				setAttrs(output);
			}); 
		}); 
	};

	on('change:rank sheet:opened', function() {  
		getAttrs(['pfc','rank','espchance','premonitionchance'], function(value) {
			let rank = parseInt(value.rank)||0;
			let psycfatcheck = rank + 13;
			let esp = 5 + rank * 3;
			let prem = 35 + rank * 2;
			setAttrs({                            
				pfc: psycfatcheck,
				espchance: esp,
				premonitionchance: prem 
				});
			});
		});
	
	on("change:repeating_meleeweapons remove:repeating_meleeweapons sheet:opened", function() {
	repeatingSum("totalweapons", "weapons", "weaponweight");
	});
	
	on("change:repeating_rangedweapons remove:repeating_rangedweapons sheet:opened", function() {
		repeatingSum("totalweapons", "weapons", "weaponweight");
		});
		
	on("change:repeating_ammo remove:repeating_ammo sheet:opened", function() {
	repeatingSum("ammoweight", "ammo", "ammoqty");
	});
	
	on("change:gc change:sf change:cp sheet:opened", function() {  
		getAttrs(["gc","sf", "cp"], function(value) {
			let gc = parseFloat(value.GC)||0;
			let sf = parseFloat(value.SF)||0;
			let cp = parseFloat(value.CP)||0;
		});
	});    
	
	on("change:repeating_inventoryitems remove:repeating_inventoryitems change:gc change:sf change:cp change:totalweapons change:ammoweight change:shield sheet:opened", function() {
	repeatingSum("totalencumbrance", "inventoryitems", ["inventoryqty", "encumbrancevalue"], "gc:1/150", "sf:1/150", "cp:1/150", "ammoweight:1/12", "totalweapons", "shield", "round");
	});
			</script>