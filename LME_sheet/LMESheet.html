<div class="3colrow">
    <img src="https://3.bp.blogspot.com/-adEKjEWUOGU/V-_PBebSONI/AAAAAAAAuaA/jldQOcWaW-MVbDVZLJ-NIpuCPYzQcTo9wCLcB/s1600/nuevologo.png" class="sheet-logo"/>
    <br/>
    <br/>
</div>
<div class="3colrow">
    <div class="col">
    	<label>Nombre:</label><input type="text" name="attr_character_nombre" />
		<label>Alineamiento:</label><input type="text" name="attr_alineamiento" />
		<label>Apariencia:</label><input type="text" name="attr_apariencia" />
	</div>

	<div class="col">
        <label>Clase:</label>
        <select name="attr_clase">
            <option value="clerigo">Clérigo</option>
            <option value="elfo">Elfo</option>
            <option value="enano">Enano</option>
            <option value="explorador">Explorador</option>
            <option value="guerrero">Guerrero</option>
            <option value="halfling">Halfling</option>
            <option value="ladron">Ladrón</option>
            <option value="mago">Mago</option>
            <option value="paladin">Paladín</option>
        </select><br/>
        <label>Nivel:</label><input type="number" name="attr_lvl" min="1"/><br/>
		<label>Experiencia:</label><input type="number" name="attr_xp" min="0" />
	</div>

	<div class="col">
        <label>Movimiento:</label><input type="number" name="attr_movimiento"  min="0"/><br/>
        <label>Mov Combate:</label><input type="number" name="attr_movimiento_combate"  min="0"/><br/>
        <label>Iniciativa:</label><button type='roll' name='roll_iniciativa' value='&{template:default} {{name=@{character_nombre} tira iniciativa}} {{result=[[1d20 + @{destreza_mod} &{tracker:+}]]}}'></button><br/>
	</div>

</div>
<hr/>
<div class="3colrow">
	<div class="col">
		<h2>Attributos</h2>
        <br/>
		<label>Fuerza </label><input type="number" name='attr_fuerza' class='sheet-short' min="0" max="30">
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} tira fuerza}} {{result=[[1d20 + @{fuerza_mod}]]}}'></button><input readonly type="text" name='attr_fuerza_mod' class='sheet-short'>
        <br />
		<label>Destreza </label><input type="number" name='attr_destreza' class='sheet-short' min="0" max="30">
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} tira destreza}} {{result=[[1d20 + @{destreza_mod}]]}}'></button><input readonly type="text" name='attr_destreza_mod' class='sheet-short'>
        <br />
		<label>Constitución </label><input type="number" name='attr_constitucion' class='sheet-short' min="0" max="30">
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} tira constitución}} {{result=[[1d20 + @{constitucion_mod}]]}}'></button><input readonly type="text" name='attr_constitucion_mod' class='sheet-short'>
        <br />
		<label>Inteligencia </label><input type="number" name='attr_inteligencia' class='sheet-short' min="0" max="30">
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} tira inteligencia}} {{result=[[1d20 + @{inteligencia_mod}]]}}'></button><input readonly type="text" name='attr_inteligencia_mod' class='sheet-short'>
        <br />
		<label>Sabiduría </label><input type="number" name='attr_sabiduria' class='sheet-short' min="0" max="30">
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} tira sabiduría}} {{result=[[1d20 + @{sabiduria_mod}]]}}'></button><input readonly type="text" name='attr_sabiduria_mod' class='sheet-short'>
        <br />
		<label>Carisma </label><input type="number" name='attr_carisma' class='sheet-short' min="0" max="30">
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} tira carisma}} {{result=[[1d20 + @{carisma_mod}]]}}'></button><input readonly type="text" name='attr_carisma_mod' class='sheet-short'>
	</div>

	<div class="col">
        <h2>Tiradas de salvación</h2>
        <br/>                                                                                                
        <label class="sheet-largue">Veneno o muerte</label><button type='roll' name='roll_testattack' value='&{template:salvacion} {{name=@{character_nombre} tira salvacion por veneno o muerte}} {{testevaluate=[[1d20 - @{salv_venomue}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_salv_venomue"  />
        <br />
        <label class="sheet-largue">Varitas mágicas</label><button type='roll' name='roll_testattack' value='&{template:salvacion} {{name=@{character_nombre} tira salvacion por varitas mágicas}} {{testevaluate=[[1d20 - @{salv_varma}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_salv_varma" />
        <br />
        <label class="sheet-largue">Petrificación o parálisis</label><button type='roll' name='roll_testattack' value='&{template:salvacion} {{name=@{character_nombre} tira salvacion por petrificación o parálisis}} {{testevaluate=[[1d20 - @{salv_petopar}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_salv_petopar"  />
        <br />
        <label class="sheet-largue">Aliento de dragón</label><button type='roll' name='roll_testattack' value='&{template:salvacion} {{name=@{character_nombre} tira salvacion por aliento de dragón}} {{testevaluate=[[1d20 - @{salv_alidra}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_salv_alidra"  />
        <br />
        <label class="sheet-largue">Sortilegios varas y báculos</label><button type='roll' name='roll_testattack' value='&{template:salvacion} {{name=@{character_nombre} tira salvacion por sortilegios}} {{testevaluate=[[1d20 - @{salv_sorybac}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_salv_sorybac"  />
	</div>

	<div class="col">

        <h2>Puntos de Golpe</h2>
        <br/>
        <label class="sheet-largue">Dado de golpe</label>
        <input type="text" name='attr_dado_golpe' class='sheet-short'/>
        <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} tira el dado de golpe}} {{result=[[@{dado_golpe}]]}}'></button>
        <br />
        <label class="sheet-largue">Puntos de vida</label>
        <input type="text" name='attr_pv' class='sheet-short'/>/<input type="text" name='attr_pv_max' class='sheet-short'/>
        <br />
        <br />
        <h2>Clase de Armadura</h2>
        <br/>
        <label class="sheet-short">CA</label>
        <input readonly type="text" name='attr_ca' class='sheet-short' value=9 />
        <br />
        <label class="sheet-short">Sorprendido</label>
        <input readonly type="text" name='attr_ca_sor' class='sheet-short' value=10 />
        <br />
        <label class="sheet-short">Armadura</label>
        <select name="attr_armadura">
            <option value="9">Sin armadura</option>
            <option value="4">Armadura de bandas</option>
            <option value="7">Armadura de Cuero</option>
            <option value="6">Armadura de Escamas</option>
            <option value="3">Armadura de Placas</option>
            <option value="4">Armadura de Varillas</option>
            <option value="5">Cota de mallas</option>
            <option value="6">Cuero tachonado</option>
        </select>
        <br />
        <label class="sheet-short">Escudo</label>
        <input type="checkbox" name='attr_escudo' class='sheet-short'/>
        <br />

	</div>

</div>
<hr/>
<div class="3colrow">
    <h2>Armas y Combate</h2>
    <br />
        <fieldset class="repeating_armas">
            <button type='roll' name='roll_testattack' value='&{template:default} {{name=@{character_nombre} ataca con @{Weapon-nombre_arma}}} {{ataque=[[ 1d20 + @{Weapon-arma_mod} + @{Weapon-modifica_magico_impacto}]]}} {{daño=[[@{Weapon-arma_dano} + @{fuerza_mod} + @{Weapon-modifica_magico_dano}]]}}'></button>
            <span>Nombre:</span><input type="text" name='attr_Weapon-nombre_arma' class='sheet-short'/>
            <select name="attr_Weapon-arma_mod" class="dtype">
                <option value="@{fuerza_mod}">Fue</option>
                <option value="@{destreza_mod}">Des</option>
            </select>
            <span>Mod magia:</span>
            <input type="number" value="0" min="0" name="attr_Weapon-modifica_magico_impacto" />
            <span>Daño:</span>
            <select name="attr_Weapon-arma_dano" class="dtype">
                <option value="d4">d4</option>
                <option value="d6">d6</option>
                <option value="d8">d8</option>
                <option value="d10">d10</option>
                <option value="d12">d12</option>
                <option value="d20">d20</option>
            </select>
            <span>Mod magia:</span>
                <input type="number" value="0" min="0" name="attr_Weapon-modifica_magico_dano" />
            <span>Especial:</span>
            <input type="text" name="attr_Weapon-arma_especial" />
        </fieldset>
</div>
<hr/>
<div class="2colrow">
    <h2>Habilidades</h2>
    <br />
    <div class="col">
        <label class="sheet-largue">Sorprendido</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por sorprendido}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_sor}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_sor" value=2 />
        <label class="sheet-largue">Escuchar ruidos</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por escuchar ruidos}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_escrui}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_escrui" value=1 />
        <label class="sheet-largue">Derribar Puertas</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por derribar puertas}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_derpue}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_derpue" value=2 />
        <label class="sheet-largue">Detectar puertas secretas</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por detectar puertas}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_detpuesec}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_detpuesec" value=0 />
        <label class="sheet-largue">Detectar trampas y fosos</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por detectar trampas}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_dettrafos}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_dettrafos" value=1 />
        <label class="sheet-largue">Rastrear en exteriores</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por rastrear exteriores}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_rasext}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_rasext" value=0 />
        <label class="sheet-largue">Restrear en interiores</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por restrear interiores}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_rasint}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_rasint" value=0 />
        <label class="sheet-largue">Ocultarse</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por ocultarse}} {{testevaluate=[[1d6]]}} {{objetive=[[@{hab_ocu}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_ocu" value=0 />
    </div>
    <div class="col">
        <label class="sheet-largue">Abrir cerraduras</label><button type='roll' name='roll_testevaluate' value='&{template:evaluate} {{name=@{character_nombre} tira por abrir cerraduras}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_abrcer}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_abrcer" value=0 />%
        <label class="sheet-largue">Encontrar/Desact. trampas</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por encontrar trampas}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_encdes}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_encdes" value=0 />%
        <label class="sheet-largue">Hurtar</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por hurtar}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_hur}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_hur" value=0 />%
        <label class="sheet-largue">Moverse en silencio</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por moverse en silencio}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_movsil}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_movsil" value=0 />%
        <label class="sheet-largue">Escalar muros</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por escalar muros}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_escmur}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_escmur" value=0 />%
        <label class="sheet-largue">Esconderse en las sombras</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por esconderse en las sombras}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_escsom}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_escsom" value=0 />%
        <label class="sheet-largue">Comprender lenguajes</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por comprender lenguajes}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_comlen}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_comlen" value=0 />%
        <label class="sheet-largue">Usar pergaminos</label><button type='roll' name='roll_testattack' value='&{template:evaluate} {{name=@{character_nombre} tira por usar pergaminos}} {{testevaluate=[[1d100]]}} {{objetive=[[@{hab_usaper}]]}}'></button><input readonly class='sheet-short' type="text" name="attr_hab_usaper" value=0 />%
    </div>
</div>
<hr/>
<div class="3colrow">
    <h2>Dinero</h2>
    <br />
    <label class="sheet-short">Platino</label><input class='sheet-short' type="number" name="attr_mon_platino" value=0 />
    <label class="sheet-short">Oro</label><input class='sheet-short' type="number" name="attr_mon_oro" value=0 />
    <label class="sheet-short">Electro</label><input class='sheet-short' type="number" name="attr_mon_electro" value=0 />
    <label class="sheet-short">Plata</label><input class='sheet-short' type="number" name="attr_mon_plata" value=0 />
    <label class="sheet-short">Cobre</label><input class='sheet-short' type="number" name="attr_mon_cobre" value=0 />
</div>
<hr/>
<div class="3colrow">
    <h2>Hechizos</h2>
    <br />
    <fieldset class="repeating_hechizo">
        <hr/>
        <span class="sheet-largue">Nombre: </span><input type="text" name='attr_Hechizo-nombre' class='sheet-largue'/> | 
        <span class="sheet-largue">Descripción: </span><input type="text" name='attr_Hechizo-resumen' class='sheet-extralargue'/><br/>
        <span class="sheet-largue">Alcance: </span><input type="number" value="0" min="0" name="attr_Hechizo-alcance" /> | 
        <span class="sheet-largue">Preparado: </span><input type="checkbox" name="attr_Hechizo-preparado"/> | 
        <span class="sheet-largue">Duración: </span><input type="number" value="0" min="0" name="attr_Hechizo-duracion" /><span> turnos.</span>
    </fieldset>
</div>
<hr/>
<div class="3colrow">
    <h2>Equipo</h2>
    <br />
    <fieldset class="repeating_equipo">
        <span class="sheet-largue">Item: </span><input type="text" name='attr_Equipo-nombre' class='sheet-largue'/>
        <span class="sheet-largue">Descripción: </span><input type="text" name='attr_Equipo-desc' class='sheet-largue'/>
        <span class="sheet-largue">Cantidad: </span><input type="number" value="0" min="0" name="attr_Equipo-cantidad" />
        <span class="sheet-largue">Peso: </span><input type="number" value="0" min="0" name="attr_Equipo-peso" /><span>kg.</span>
    </fieldset>
</div>

<rolltemplate class="sheet-rolltemplate-salvacion">
    <table>
        <caption>{{name}}</caption>
        <tbody>
            <tr>
                <td>Tirada:</td><td><span>{{testevaluate}}</span></td>
            </tr>
            <tr>
                <td>Resultado:</td>
                <td>
                    {{#rollLess() testevaluate 0}}
                    <span>Fallo</span>
                    {{/rollLess() testevaluate 0}}
                    {{#rollGreater() testevaluate 0}}
                    <span>Éxito</span>
                    {{/rollGreater() testevaluate 0}}
                </td>
            </tr>
        </tbody>
    </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-evaluate">
    <table>
        <caption>{{name}}</caption>
        <tbody>
            <tr>
                <td>Tirada:</td><td><span>{{testevaluate}}</span></td>
            </tr>
            <tr>
                <td>Resultado:</td>
                <td>
                    {{#rollBetween() testevaluate 0 objetive}}
                    <span>Éxito</span>
                    {{/rollBetween() testevaluate 0 objetive}}
                    {{#rollGreater() testevaluate objetive}}
                    <span>Fallo</span>
                    {{/rollGreater() testevaluate objetive}}
                </td>
            </tr>
        </tbody>
    </table>
</rolltemplate>

<script type="text/worker">
    // <!-- Modificadores -->
	function StatMod(stat) {
		let mod = 0;
		if (stat <= 3) {
			mod = -3;
	  	} else if (stat <= 5) {
		 	mod = -2;
	  	} else if (stat <= 8) {
		  	mod = -1;
	  	} else if (stat <= 12) {
		  	mod = 0;
	  	} else if (stat <= 15) {
		  	mod = 1;
	  	} else if (stat <= 17) {
		  	mod = 2;
		} else if (stat >= 5) {
			mod = 3;
	  }
	  return mod;  
	};
	
	const stats = ['fuerza','destreza','constitucion','inteligencia','sabiduria','carisma'];
	stats.forEach(stat => {
		on(`change:${stat} sheet:opened`, () => {
			getAttrs([stat], values => {
				const stat_score = parseInt(values[stat], 10)||0;
				const stat_modifier = StatMod(stat_score);
				setAttrs({
					[`${stat}_mod`]: stat_modifier 
				});
			});
		});
    });

    // <!--CA-->
    function CalcularCA(){
        getAttrs(["destreza_mod","escudo","armadura"],(values)=>{
            var modDes = parseInt(values.destreza_mod);
            if(values.escudo === "on"){
                var escudoAux = 1;
            }else{
                var escudoAux = parseInt(values.escudo);
            }
            var armaduraAux = parseInt(values.armadura);
            var CAcalcu = armaduraAux - modDes - escudoAux;
            var CAsorpre = armaduraAux - escudoAux;

            setAttrs({
                "ca":CAcalcu,
                "ca_sor": CAsorpre
            });
        });
    }

    on("change:destreza_mod",(obj)=>{
        CalcularCA();
    });
    
    on("change:armadura",(obj)=>{
        CalcularCA();
    });

    on("change:escudo", (obj)=>{
        CalcularCA();
    });

    // <!--Cosas de clase-->
    function CalcularClase(){
        getAttrs(['clase','lvl'],(values) => {
            var nivel = parseInt(values.lvl);
            var claseAux = values.clase;
            if(claseAux === "clerigo"){
                setAttrs({
                    "dado_golpe":"1d6"
                });
                if(nivel <= 4){
                    setAttrs({
                        "salv_venomue": 11,
                        "salv_varma": 12,
                        "salv_petopar": 14,
                        "salv_alidra": 16,
                        "salv_sorybac": 15
                    });
                }else if(nivel <=8){
                    setAttrs({
                        "salv_venomue": 9,
                        "salv_varma": 10,
                        "salv_petopar": 12,
                        "salv_alidra": 14,
                        "salv_sorybac": 12
                    });
                }else if(nivel <= 12){
                    setAttrs({
                        "salv_venomue": 7,
                        "salv_varma": 8,
                        "salv_petopar": 10,
                        "salv_alidra": 12,
                        "salv_sorybac": 9
                    });
                }else if(nivel <= 16){
                    setAttrs({
                        "salv_venomue": 3,
                        "salv_varma": 4,
                        "salv_petopar": 8,
                        "salv_alidra": 8,
                        "salv_sorybac": 6
                    });
                }else{
                    setAttrs({
                        "salv_venomue": 2,
                        "salv_varma": 4,
                        "salv_petopar": 6,
                        "salv_alidra": 6,
                        "salv_sorybac": 5
                    });
                }
            }else if(claseAux === "elfo"){
                setAttrs({
                    "dado_golpe":"1d6",
                    "hab_detpuesec":2
                });
                if(nivel <= 3){
                    setAttrs({
                        "salv_venomue": 12,
                        "salv_varma": 13,
                        "salv_petopar": 13,
                        "salv_alidra": 15,
                        "salv_sorybac": 15
                    });
                }else if(nivel <=6){
                    setAttrs({
                        "salv_venomue": 10,
                        "salv_varma": 11,
                        "salv_petopar": 11,
                        "salv_alidra": 13,
                        "salv_sorybac": 13
                    });
                }else if(nivel <= 9){
                    setAttrs({
                        "salv_venomue": 8,
                        "salv_varma": 9,
                        "salv_petopar": 9,
                        "salv_alidra": 9,
                        "salv_sorybac": 11
                    });
                }else if(nivel <= 10){
                    setAttrs({
                        "salv_venomue": 6,
                        "salv_varma": 7,
                        "salv_petopar": 7,
                        "salv_alidra": 7,
                        "salv_sorybac": 9
                    });
                }
            }else if(claseAux === "enano"){
                setAttrs({
                    "dado_golpe":"1d8",
                    "hab_detpuesec":2,
                    "hab_dettrafos":2
                });
                if(nivel <= 3){
                    setAttrs({
                        "salv_venomue": 8,
                        "salv_varma": 9,
                        "salv_petopar": 10,
                        "salv_alidra": 13,
                        "salv_sorybac": 12
                    });
                }else if(nivel <=6){
                    setAttrs({
                        "salv_venomue": 6,
                        "salv_varma": 7,
                        "salv_petopar": 8,
                        "salv_alidra": 10,
                        "salv_sorybac": 10
                    });
                }else if(nivel <= 9){
                    setAttrs({
                        "salv_venomue": 4,
                        "salv_varma": 5,
                        "salv_petopar": 6,
                        "salv_alidra": 7,
                        "salv_sorybac": 8
                    });
                }else if(nivel <= 12){
                    setAttrs({
                        "salv_venomue": 2,
                        "salv_varma": 3,
                        "salv_petopar": 4,
                        "salv_alidra": 4,
                        "salv_sorybac": 6
                    });
                }
            }else if(claseAux === "explorador" || claseAux === "guerrero" || claseAux === "paladin"){
                setAttrs({
                    "dado_golpe":"1d8"
                });
                if(claseAux === "explorador" ){
                    setAttrs({
                        "hab_sor":3,
                        "hab_rasext":5,
                        "hab_rasint":4
                    });
                }
                if(nivel <= 3){
                    setAttrs({
                        "salv_venomue": 12,
                        "salv_varma": 13,
                        "salv_petopar": 14,
                        "salv_alidra": 15,
                        "salv_sorybac": 16
                    });
                }else if(nivel <=6){
                    setAttrs({
                        "salv_venomue": 10,
                        "salv_varma": 11,
                        "salv_petopar": 12,
                        "salv_alidra": 13,
                        "salv_sorybac": 14
                    });
                }else if(nivel <= 9){
                    setAttrs({
                        "salv_venomue": 8,
                        "salv_varma": 9,
                        "salv_petopar": 10,
                        "salv_alidra": 9,
                        "salv_sorybac": 12
                    });
                }else if(nivel <= 12){
                    setAttrs({
                        "salv_venomue": 6,
                        "salv_varma": 7,
                        "salv_petopar": 8,
                        "salv_alidra": 7,
                        "salv_sorybac": 10
                    });
                }else if(nivel <= 15){
                    setAttrs({
                        "salv_venomue": 4,
                        "salv_varma": 5,
                        "salv_petopar": 6,
                        "salv_alidra": 5,
                        "salv_sorybac": 8
                    });
                }else if(nivel <= 18){
                    setAttrs({
                        "salv_venomue": 4,
                        "salv_varma": 4,
                        "salv_petopar": 5,
                        "salv_alidra": 4,
                        "salv_sorybac": 7
                    });
                }else{
                    setAttrs({
                        "salv_venomue": 3,
                        "salv_varma": 3,
                        "salv_petopar": 4,
                        "salv_alidra": 4,
                        "salv_sorybac": 6
                    });
                }
            }else if(claseAux === "halfling"){
                setAttrs({
                    "dado_golpe":"1d6",
                    "hab_ocu":4
                });
                if(nivel <= 3){
                    setAttrs({
                        "salv_venomue": 8,
                        "salv_varma": 9,
                        "salv_petopar": 10,
                        "salv_alidra": 13,
                        "salv_sorybac": 12
                    });
                }else if(nivel <=6){
                    setAttrs({
                        "salv_venomue": 6,
                        "salv_varma": 7,
                        "salv_petopar": 8,
                        "salv_alidra": 10,
                        "salv_sorybac": 10
                    });
                }else if(nivel <= 9){
                    setAttrs({
                        "salv_venomue": 4,
                        "salv_varma": 5,
                        "salv_petopar": 6,
                        "salv_alidra": 7,
                        "salv_sorybac": 8
                    });
                }
            }else if(claseAux === "ladron"){
                setAttrs({
                    "dado_golpe":"1d4"
                });
                if(nivel <= 4){
                    setAttrs({
                        "salv_venomue": 16,
                        "salv_varma": 15,
                        "salv_petopar": 13,
                        "salv_alidra": 16,
                        "salv_sorybac": 14
                    });
                }else if(nivel <= 8){
                    setAttrs({
                        "salv_venomue": 14,
                        "salv_varma": 13,
                        "salv_petopar": 11,
                        "salv_alidra": 14,
                        "salv_sorybac": 12
                    });
                }else if(nivel <= 12){
                    setAttrs({
                        "salv_venomue": 12,
                        "salv_varma": 11,
                        "salv_petopar": 9,
                        "salv_alidra": 12,
                        "salv_sorybac": 10
                    });
                }else if(nivel <= 16){
                    setAttrs({
                        "salv_venomue": 10,
                        "salv_varma": 9,
                        "salv_petopar": 7,
                        "salv_alidra": 10,
                        "salv_sorybac": 8
                    });
                }else{
                    setAttrs({
                        "salv_venomue": 8,
                        "salv_varma": 7,
                        "salv_petopar": 5,
                        "salv_alidra": 8,
                        "salv_sorybac": 6
                    });
                }
                if(nivel == 1){
                    setAttrs({
                        "hab_escrui":2,
                        "hab_abrcer":17,
                        "hab_encdes":14,
                        "hab_hur":23,
                        "hab_movsil":23,
                        "hab_escmur":87,
                        "hab_escsom":13
                    });
                }else if(nivel == 2){
                    setAttrs({
                        "hab_escrui":2,
                        "hab_abrcer":23,
                        "hab_encdes":17,
                        "hab_hur":27,
                        "hab_movsil":27,
                        "hab_escmur":88,
                        "hab_escsom":17
                    });
                }else if(nivel == 3){
                    setAttrs({
                        "hab_escrui":3,
                        "hab_abrcer":27,
                        "hab_encdes":20,
                        "hab_hur":30,
                        "hab_movsil":30,
                        "hab_escmur":89,
                        "hab_escsom":20
                    });
                }else if(nivel == 4){
                    setAttrs({
                        "hab_escrui":3,
                        "hab_abrcer":31,
                        "hab_encdes":23,
                        "hab_hur":37,
                        "hab_movsil":37,
                        "hab_escmur":90,
                        "hab_escsom":27,
                        "hab_comlen":80
                    });
                }else if(nivel == 5){
                    setAttrs({
                        "hab_escrui":3,
                        "hab_abrcer":35,
                        "hab_encdes":33,
                        "hab_hur":40,
                        "hab_movsil":40,
                        "hab_escmur":91,
                        "hab_escsom":30,
                        "hab_comlen":80
                    });
                }else if(nivel == 6){
                    setAttrs({
                        "hab_escrui":4,
                        "hab_abrcer":45,
                        "hab_encdes":43,
                        "hab_hur":43,
                        "hab_movsil":43,
                        "hab_escmur":92,
                        "hab_escsom":37,
                        "hab_comlen":80
                    });
                }else if(nivel == 7){
                    setAttrs({
                        "hab_escrui":4,
                        "hab_abrcer":55,
                        "hab_encdes":53,
                        "hab_hur":53,
                        "hab_movsil":53,
                        "hab_escmur":93,
                        "hab_escsom":47,
                        "hab_comlen":80
                    });
                }else if(nivel == 8){
                    setAttrs({
                        "hab_escrui":4,
                        "hab_abrcer":65,
                        "hab_encdes":63,
                        "hab_hur":63,
                        "hab_movsil":63,
                        "hab_escmur":94,
                        "hab_escsom":57,
                        "hab_comlen":80
                    });
                }else if(nivel == 9){
                    setAttrs({
                        "hab_escrui":4,
                        "hab_abrcer":75,
                        "hab_encdes":73,
                        "hab_hur":73,
                        "hab_movsil":73,
                        "hab_escmur":95,
                        "hab_escsom":67,
                        "hab_comlen":80
                    });
                }else if(nivel == 10){
                    setAttrs({
                        "hab_escrui":5,
                        "hab_abrcer":85,
                        "hab_encdes":83,
                        "hab_hur":83,
                        "hab_movsil":83,
                        "hab_escmur":96,
                        "hab_escsom":77,
                        "hab_comlen":80,
                        "hab_usaper":90
                    });
                }else if(nivel == 11){
                    setAttrs({
                        "hab_escrui":5,
                        "hab_abrcer":95,
                        "hab_encdes":93,
                        "hab_hur":93,
                        "hab_movsil":93,
                        "hab_escmur":97,
                        "hab_escsom":87,
                        "hab_comlen":80,
                        "hab_usaper":90
                    });
                }else if(nivel == 12){
                    setAttrs({
                        "hab_escrui":5,
                        "hab_abrcer":97,
                        "hab_encdes":95,
                        "hab_hur":105,
                        "hab_movsil":95,
                        "hab_escmur":98,
                        "hab_escsom":90,
                        "hab_comlen":80,
                        "hab_usaper":90
                    });
                }else if(nivel == 13){
                    setAttrs({
                        "hab_escrui":5,
                        "hab_abrcer":99,
                        "hab_encdes":97,
                        "hab_hur":115,
                        "hab_movsil":99,
                        "hab_escmur":97,
                        "hab_escsom":99,
                        "hab_comlen":80,
                        "hab_usaper":90
                    });
                }else if(nivel >= 14){
                    setAttrs({
                        "hab_escrui":5,
                        "hab_abrcer":99,
                        "hab_encdes":99,
                        "hab_hur":125,
                        "hab_movsil":99,
                        "hab_escmur":99,
                        "hab_escsom":99,
                        "hab_comlen":80,
                        "hab_usaper":90
                    });
                }
            }else if(claseAux === "mago"){
                setAttrs({
                    "dado_golpe":"1d4"
                });
                if(nivel <= 5){
                    setAttrs({
                        "salv_venomue": 13,
                        "salv_varma": 13,
                        "salv_petopar": 13,
                        "salv_alidra": 16,
                        "salv_sorybac": 14
                    });
                }else if(nivel <= 10){
                    setAttrs({
                        "salv_venomue": 11,
                        "salv_varma": 11,
                        "salv_petopar": 11,
                        "salv_alidra": 14,
                        "salv_sorybac": 12
                    });
                }else if(nivel <= 15){
                    setAttrs({
                        "salv_venomue": 9,
                        "salv_varma": 9,
                        "salv_petopar": 9,
                        "salv_alidra": 12,
                        "salv_sorybac": 8
                    });
                }else if(nivel <= 18){
                    setAttrs({
                        "salv_venomue": 7,
                        "salv_varma": 5,
                        "salv_petopar": 6,
                        "salv_alidra": 8,
                        "salv_sorybac": 6
                    });
                }else{
                    setAttrs({
                        "salv_venomue": 6,
                        "salv_varma": 4,
                        "salv_petopar": 5,
                        "salv_alidra": 7,
                        "salv_sorybac": 4
                    });
                }
            }
        });
    }
    
    on("change:lvl", (obj) =>{
        CalcularClase();
    });

    on("change:clase", (obj) =>{
        CalcularClase();
    });

</script>